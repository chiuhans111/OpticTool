{"version":3,"file":"js/app.45dca32e.js","mappings":"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","sources":["webpack://optictool/./src/App.vue","webpack://optictool/./src/components/LensSheet.vue","webpack://optictool/./src/scripts/compress.js","webpack://optictool/./src/scripts/Serializer.js","webpack://optictool/./src/optic/material/OpticMaterial.js","webpack://optictool/./src/optic/OpticVar.js","webpack://optictool/./src/optic/shapes/OpticShapeSpherical.js","webpack://optictool/./src/optic/OpticSurface.js","webpack://optictool/./src/optic/OpticField.js","webpack://optictool/./src/optic/OpticSystem.js","webpack://optictool/./src/components/common/SheetUI.vue","webpack://optictool/./src/components/common/SheetUI.vue?585d","webpack://optictool/./src/components/OpticSurfaceComponent.vue","webpack://optictool/./src/components/common/OpticVarInput.vue","webpack://optictool/./src/scripts/throttle.js","webpack://optictool/./src/components/common/OpticVarInput.vue?027c","webpack://optictool/./src/components/OpticSurfaceComponent.vue?b88a","webpack://optictool/./src/components/ViewControl.js","webpack://optictool/./src/components/LensSheet.vue?c9b6","webpack://optictool/./src/components/LensPlot.vue","webpack://optictool/./src/optic/analyze/RayTrace.js","webpack://optictool/./src/optic/analyze/PlotTrace.js","webpack://optictool/./src/components/LensPlot.vue?38c6","webpack://optictool/./src/optic/index.js","webpack://optictool/./src/components/FieldSheet.vue","webpack://optictool/./src/components/OpticFieldComponent.vue","webpack://optictool/./src/components/OpticFieldComponent.vue?f754","webpack://optictool/./src/components/FieldSheet.vue?7e0e","webpack://optictool/./src/components/AnalyzePlot.vue","webpack://optictool/./src/optic/analyze/SpotTrace.js","webpack://optictool/./src/components/AnalyzePlot.vue?afb0","webpack://optictool/./src/components/OptimizeWizard.vue","webpack://optictool/./src/optic/analyze/Merit.js","webpack://optictool/./src/optic/analyze/Optimize.js","webpack://optictool/./src/components/OptimizeWizard.vue?f450","webpack://optictool/./src/scripts/debounce.js","webpack://optictool/./src/App.vue?7ccd","webpack://optictool/./src/main.js","webpack://optictool/webpack/bootstrap","webpack://optictool/webpack/runtime/amd define","webpack://optictool/webpack/runtime/amd options","webpack://optictool/webpack/runtime/chunk loaded","webpack://optictool/webpack/runtime/compat get default export","webpack://optictool/webpack/runtime/define property getters","webpack://optictool/webpack/runtime/global","webpack://optictool/webpack/runtime/hasOwnProperty shorthand","webpack://optictool/webpack/runtime/make namespace object","webpack://optictool/webpack/runtime/node module decorator","webpack://optictool/webpack/runtime/jsonp chunk loading","webpack://optictool/webpack/startup"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"row\">\r\n      <h2>Optic Tool </h2>\r\n      <div></div>\r\n      <button @click=\"open\">Open</button>\r\n      <button @click=\"save\">Save</button>\r\n      <div></div>\r\n      <button @click=\"undo\">Undo\r\n        {{ this.stateHead - 1 }}</button>\r\n      <button @click=\"redo\">Redo\r\n        {{ this.state.length - this.stateHead }}</button>\r\n    </div>\r\n    <div class=\"row top_row\">\r\n      <LensPlot :system=\"system\"></LensPlot>\r\n      <AnalyzePlot :system=\"system\"></AnalyzePlot>\r\n    </div>\r\n    <div class=\"row\">\r\n      <LensSheet :system=\"system\"></LensSheet>\r\n      <FieldSheet :system=\"system\"></FieldSheet>\r\n      <OptimizeWizard :system=\"system\"></OptimizeWizard>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"content\">\r\n        <h3>About this project</h3>\r\n        <p>Developer: <a\r\n            href=\"https://chiuhans111.github.io\">Hans\r\n            Chiu</a></p>\r\n        <p>Project repo: <a\r\n            href=\"https://github.com/chiuhans111/OpticTool\">https://github.com/chiuhans111/OpticTool</a>\r\n        </p>\r\n      </div>\r\n      <div class=\"content\">\r\n        <h3>How to use?</h3>\r\n        <p>Drag the input box to modify value.</p>\r\n        <p>Click the input box to edit and set optimization\r\n          variable.</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LensSheet from './components/LensSheet.vue'\r\nimport LensPlot from './components/LensPlot.vue'\r\nimport optic from './optic'\r\nimport serializer from './scripts/Serializer'\r\nimport FieldSheet from './components/FieldSheet.vue'\r\nimport AnalyzePlot from './components/AnalyzePlot.vue'\r\nimport OptimizeWizard from './components/OptimizeWizard.vue'\r\nimport { throttle } from './scripts/throttle'\r\nimport { debounce } from './scripts/debounce'\r\nimport { toRaw } from 'vue'\r\nexport default {\r\n  name: 'App',\r\n  data() {\r\n    return {\r\n      system: optic.system,\r\n      state: [],\r\n      no_record: false,\r\n      stateHead: 0\r\n    }\r\n  },\r\n  components: {\r\n    LensSheet,\r\n    LensPlot,\r\n    FieldSheet,\r\n    AnalyzePlot,\r\n    OptimizeWizard\r\n  },\r\n  mounted() {\r\n    this.push()\r\n  },\r\n  methods: {\r\n    undo() {\r\n      this.no_record = true\r\n      if (this.stateHead > 1)\r\n        this.stateHead--\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    redo() {\r\n      this.no_record = true\r\n      if (this.stateHead < this.state.length)\r\n        this.stateHead++\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    load(str) {\r\n      this.system = serializer.deserialize(str)\r\n    },\r\n    push: debounce(200, throttle(500, function () {\r\n      this.state.splice(this.stateHead)\r\n      let str = serializer.serialize(toRaw(this.system))\r\n      if (this.state.length == 0 || str !== this.state[this.state.length - 1]) {\r\n        this.state.push(str)\r\n        this.stateHead += 1\r\n      }\r\n    })),\r\n\r\n    open() {\r\n      let a = document.createElement('input')\r\n      a.type = 'file'\r\n      let vm = this\r\n      a.onchange = function () {\r\n        const reader = new FileReader()\r\n        reader.readAsText(a.files[0], \"UTF-8\")\r\n        reader.onload = function (e) {\r\n          vm.load(e.target.result)\r\n        }\r\n      }\r\n      a.click()\r\n\r\n\r\n    },\r\n    save() {\r\n      let filename = \"lens.json\"\r\n      var contents = serializer.serialize(toRaw(this.system))\r\n      var blob = new Blob([contents], { type: 'text/plain' })\r\n      var file = new File([blob], filename, { type: \"text/plain\" })\r\n      let a = document.createElement('a')\r\n      let e = document.createEvent('MouseEvents')\r\n      a.download = filename\r\n      a.href = window.URL.createObjectURL(blob)\r\n      a.dataset.downloadurl = ['text/obj', a.download, a.href].join(':')\r\n      a.click()\r\n    }\r\n  },\r\n  watch: {\r\n    system: {\r\n      handler() {\r\n        if (!this.no_record)\r\n          this.push()\r\n        this.no_record = false\r\n      },\r\n      deep: true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.top_row>div {\r\n  height: 450px;\r\n}\r\n</style>\r\n","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Lens Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n\r\n            <SheetUI :list=\"system.surfaces\"\r\n                :builder=\"buildSurface\">\r\n                <template #item=\"[surface, i]\">\r\n                    <OpticSurfaceComponent\r\n                        :surface=\"surface\" :key=\"i\">\r\n                    </OpticSurfaceComponent>\r\n                </template>\r\n            </SheetUI>\r\n\r\n            <div class=\"content\">\r\n                <p>t=thickness, c=curvature (1/R), n=index\r\n                    of\r\n                    refraction</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport SheetUI from './common/SheetUI.vue'\r\nimport OpticSurfaceComponent from './OpticSurfaceComponent.vue'\r\nimport ViewState from './ViewControl'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticSurfaceComponent,\r\n        SheetUI\r\n    },\r\n    methods: {\r\n        buildSurface(i) {\r\n            return new OpticSurface()\r\n        },\r\n        hover(surface) {\r\n            ViewState.focusedSurface = surface\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","/**\r\n * @param {string} str \r\n * @returns \r\n */\r\nfunction compress(str) {\r\n    str = str.replaceAll(/\"([^\",{}]+)\":/g, \"$1:\")\r\n    str = str.replaceAll(/{_:\"([^\",{}]+)\",/g, \"{$1,\")\r\n    str = str.replaceAll(/true/g, \"_1\")\r\n    str = str.replaceAll(/false/g, \"_0\")\r\n    return str\r\n}\r\n\r\n/**\r\n * @param {string} str \r\n * @returns \r\n */\r\nfunction decompress(str) {\r\n    str = str.replaceAll(/_1/g, \"true\")\r\n    str = str.replaceAll(/_0/g, \"false\")\r\n    str = str.replaceAll(/{([^\",{}]+),/g, '{_:\"$1\",')\r\n    str = str.replaceAll(/([^,\"{}]+):/g, '\"$1\":')\r\n    return str\r\n}\r\n\r\nexport { compress, decompress }","import { compress, decompress } from \"./compress\"\r\n\r\nclass Serializer {\r\n    classdefs = {}\r\n    classnames = {}\r\n\r\n    serializable(classname, param2v) {\r\n        const serializer = this\r\n        return function decorator(Class) {\r\n            if (classname in serializer.classdefs) console.error(\"duplicated classname\", classname)\r\n            if (Class.name in serializer.classnames) console.error(\"duplicated class\", Class.name)\r\n            const v2param = {}\r\n            for (let i in param2v) v2param[param2v[i]] = i\r\n            serializer.classdefs[classname] = {\r\n                Class, param2v, v2param\r\n            }\r\n            serializer.classnames[Class.name] = classname\r\n            return Class\r\n        }\r\n    }\r\n\r\n    serialize(object) {\r\n        return compress(JSON.stringify(this._serialize(object)))\r\n    }\r\n\r\n    _serialize(object) {\r\n        if (object instanceof Array) {\r\n            return object.map(x => this._serialize(x))\r\n        } else if (object instanceof Object) {\r\n            const obj = {}\r\n            if (object.constructor.name in this.classnames) {\r\n                obj._ = this.classnames[object.constructor.name]\r\n                const p2v = this.classdefs[obj._].param2v\r\n                for (let i in p2v) obj[p2v[i]] = this._serialize(object[i])\r\n            } else {\r\n                for (let i in object) obj[i] = this._serialize(object[i])\r\n            }\r\n            return obj\r\n        }\r\n        return object\r\n    }\r\n\r\n    deserialize(str, obj) {\r\n        return this._deserialize(JSON.parse(decompress(str)), obj)\r\n    }\r\n\r\n    _deserialize(object) {\r\n        if (object instanceof Array) {\r\n            return object.map(x => this._deserialize(x))\r\n        } else if (object instanceof Object) {\r\n            if (object._ && object._ in this.classdefs) {\r\n                const classdef = this.classdefs[object._]\r\n                const obj = new classdef.Class()\r\n                const v2p = classdef.v2param\r\n                for (let i in v2p) obj[v2p[i]] = this._deserialize(object[i])\r\n                return obj\r\n            } else {\r\n                const obj = {}\r\n                for (let i in object) obj[i] = this._deserialize(object[i])\r\n                return obj\r\n            }\r\n        } return object\r\n    }\r\n}\r\n\r\nconst serializer = new Serializer()\r\n\r\nexport default serializer\r\n","import serializer from \"../../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"n\", {\r\n    index: \"n\",\r\n})\r\nclass OpticMaterial {\r\n    index = 1\r\n    constructor(index) {\r\n        this.index = index || this.index\r\n    }\r\n}\r\n\r\nexport default OpticMaterial","import serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"v\", {\r\n    value: \"v\",\r\n    optimize: \"o\"\r\n})\r\n\r\nclass OpticVar {\r\n    value = 0\r\n    optimize = false\r\n    constructor(value) {\r\n        this.value = value || 0\r\n    }\r\n\r\n    num() {\r\n        const value = Number(this.value)\r\n        return isNaN(value) ? 0 : value\r\n    }\r\n}\r\n\r\nexport default OpticVar","import * as tf from \"@tensorflow/tfjs\"\r\n// import { toRaw } from \"vue\"\r\nimport OpticVar from \"../OpticVar\"\r\nimport serializer from \"../../scripts/Serializer\"\r\n\r\n// function ensurevalue(v) {\r\n//     if (v instanceof tf.Tensor) {\r\n//         return v.arraySync()[0]\r\n//     }\r\n//     else return v\r\n// }\r\n\r\n@serializer.serializable(\r\n    \"o\", {\r\n    curvature: \"c\",\r\n})\r\nclass OpticShapeSpherical {\r\n    curvature = new OpticVar(0)\r\n\r\n    constructor(curvature) {\r\n        this.curvature.value = curvature || this.curvature.value\r\n    }\r\n\r\n    /** Find intersection position\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @param {tf.Tensor} raydir direction of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} intersection position\r\n    */\r\n    trace(raypos, raydir) {\r\n        const c = this.curvature.num()\r\n        return tf.tidy(() => {\r\n            let l = raypos.gather(2).div(raydir.gather(2)).mul(-1)\r\n\r\n            if (c != 0) {\r\n                const A = raydir.mul(raydir).sum(0).mul(c)\r\n                const B = raypos.mul(raydir).sum(0).mul(c).sub(raydir.gather(2)).mul(2)\r\n                const C = raypos.mul(raypos).sum(0).mul(c).sub(raypos.gather(2).mul(2))\r\n                l = B.mul(-1).sub(B.mul(B).sub(A.mul(C).mul(4)).sqrt()).div(A).div(2)\r\n                A.dispose()\r\n                B.dispose()\r\n                C.dispose()\r\n            }\r\n\r\n            return raypos.add(raydir.mul(l))\r\n        })\r\n    }\r\n\r\n    /** Find the normal vector\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} normal vector at given position\r\n    */\r\n    normal(raypos) {\r\n        const c = this.curvature.num()\r\n\r\n        return tf.tidy(() => {\r\n            let p = raypos.mul(0).add(tf.tensor([[0], [0], [-1]]))\r\n            if (c != 0) {\r\n                let n = raypos.sub(tf.tensor([[0], [0], [1]]).div(c))\r\n                p = n.div(n.mul(n).sum(0).sqrt())\r\n            }\r\n\r\n            return p\r\n        })\r\n    }\r\n\r\n    surface(r) {\r\n        const r2 = r ** 2\r\n        return r2 * this.curvature.num() / (1 + Math.sqrt(1 - r2 * this.curvature.num() ** 2))\r\n    }\r\n}\r\n\r\nexport default OpticShapeSpherical","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport OpticShapeSpherical from \"./shapes/OpticShapeSpherical\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"s\", {\r\n    thickness: \"t\",\r\n    shape: \"s\",\r\n    material: \"n\",\r\n})\r\nclass OpticSurface {\r\n    thickness = new OpticVar()\r\n    shape = new OpticShapeSpherical()\r\n    material = new OpticMaterial()\r\n\r\n    constructor(thickness, curvature, material) {\r\n        this.thickness.value = thickness || this.thickness.value\r\n        this.shape.curvature.value = curvature || this.shape.curvature.value\r\n        this.material = material || this.material\r\n    }\r\n}\r\n\r\n\r\nexport default OpticSurface","import OpticSystem from \"./OpticSystem\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"f\", {\r\n    angle: \"a\",\r\n})\r\nclass OpticField {\r\n    angle = new OpticVar(0)\r\n\r\n    constructor(angle) {\r\n        this.angle.value = angle || this.angle.value\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Number} f \r\n     * @param {OpticSystem} system \r\n     * @returns \r\n     */\r\n    raypos(fx, fy, system) {\r\n        const R = system.pupilDiameter.num() / 2\r\n        const PZ = system.pupilOffset.num()\r\n        const a = this.angle.num()\r\n\r\n        const z = -1\r\n        const x = fx * R\r\n        const y = fy * R + (PZ - z) * Math.sin(a / 180 * Math.PI)\r\n        return [x, y, z]\r\n    }\r\n\r\n    raydir(fx, fy) {\r\n        return [0, -Math.sin(this.angle.num() / 180 * Math.PI), Math.cos(this.angle.num() / 180 * Math.PI)]\r\n    }\r\n}\r\n\r\nexport default OpticField","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticField from \"./OpticField\"\r\nimport OpticSurface from \"./OpticSurface\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"$\", {\r\n    surfaces: \"s\",\r\n    fields: \"f\",\r\n    pupilDiameter: \"D\",\r\n    pupilOffset: \"Z\"\r\n})\r\nclass OpticSystem {\r\n    surfaces = [\r\n        new OpticSurface(3, 0.066667, new OpticMaterial(1.515)),\r\n        new OpticSurface(4, -0.01316, new OpticMaterial(1)),\r\n        new OpticSurface(1.5, -0.05882, new OpticMaterial(1.6438)),\r\n        new OpticSurface(2.5, 0.0625, new OpticMaterial(1)),\r\n        new OpticSurface(3, 0.022727, new OpticMaterial(1.515)),\r\n        new OpticSurface(40, -0.07143, new OpticMaterial(1)),\r\n        new OpticSurface(0, 0, new OpticMaterial(1))\r\n    ]\r\n\r\n    fields = [\r\n        new OpticField(0),\r\n        new OpticField(10),\r\n        new OpticField(20),\r\n    ]\r\n\r\n    pupilDiameter = new OpticVar(10)\r\n    pupilOffset = new OpticVar(10)\r\n\r\n    update = 0\r\n}\r\n\r\n\r\nexport default OpticSystem","<template>\r\n    <div class=\"ui_sheet\">\r\n        <transition-group name=\"list\" tag=\"div\"\r\n            class=\"ui_sheet-group\">\r\n            <div class=\"ui_sheet-row list-item\"\r\n                v-for=\"item, i in list\" :key=\"getid(item)\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button class=\"ui_sheet-btn\"\r\n                            @click=\"delItem(i)\">Del</button>\r\n                        <button class=\"ui_sheet-btn\"\r\n                            @click=\"addItem(i)\">Add</button>\r\n                    </div>\r\n                    <slot name=\"item\" v-bind=\"[item, i]\">\r\n\r\n                    </slot>\r\n                </div>\r\n            </div>\r\n        </transition-group>\r\n\r\n        <div class=\"ui_sheet-row\">\r\n            <div class=\"row\">\r\n                <button\r\n                    @click=\"addItem(list.length)\">Add</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { toRaw } from 'vue'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        list: Array,\r\n        builder: Function\r\n    },\r\n    methods: {\r\n        addItem(i) {\r\n            this.list.splice(i, 0, this.builder(i))\r\n        },\r\n        delItem(i) {\r\n            this.list.splice(i, 1)\r\n        },\r\n        getid(item) {\r\n            item = toRaw(item)\r\n            if (item._id_ === undefined) {\r\n                let i = 0\r\n                while (this.list.some(x => x._id_ == i)) i++\r\n                item._id_ = i\r\n            }\r\n            return item._id_\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./SheetUI.vue?vue&type=template&id=072795c2\"\nimport script from \"./SheetUI.vue?vue&type=script&lang=js\"\nexport * from \"./SheetUI.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <tr>\r\n        <label for=\"curvature\">c=</label>\r\n        <OpticVarInput id=\"curvature\" type=\"number\"\r\n            :step=\"0.0001\"\r\n            :variable=\"surface.shape.curvature\" />\r\n\r\n\r\n        <span>, </span>\r\n        <label for=\"thickness\">t=</label>\r\n        <OpticVarInput id=\"thickness\" :step=\"0.01\"\r\n            :variable=\"surface.thickness\" />\r\n\r\n        <span>, </span>\r\n        <label for=\"material\">n=</label>\r\n        <input id=\"material\" type=\"number\" step=\"0.01\"\r\n            min=\"1\" max=\"99\"\r\n            v-model.number=\"surface.material.index\">\r\n\r\n\r\n        <span> (R={{ (1 /\r\n                surface.shape.curvature.value).toPrecision(4)\r\n        }})\r\n        </span>\r\n    </tr>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        surface: OpticSurface\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","<template>\r\n    <div class=\"optic_var_input\" :class=\"{\r\n        'optic_var_input-editmode': editmode,\r\n        'optic_var_input-optimize': variable.optimize\r\n    }\">\r\n        <input class=\"draggable\" ref=\"input\" type=\"number\"\r\n            v-model.number=\"variable.value\" :step=\"step\">\r\n\r\n        <div ref=\"menu\" class=\"optic_var_input-menu\"\r\n            v-if=\"editmode\" @mousedown=\"menuclick\">\r\n            <div class=\"ui_block\">\r\n                <div class=\"ui_block-body\">\r\n                    <div class=\"content\">\r\n                        <input type=\"checkbox\"\r\n                            name=\"optimize\" id=\"optimize\"\r\n                            v-model=\"variable.optimize\">\r\n                        <label\r\n                            for=\"optimize\">Optimize</label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticVar from '@/optic/OpticVar'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        variable: OpticVar,\r\n        step: Number\r\n    },\r\n    data() {\r\n        return {\r\n            editmode: false,\r\n            tweakmode: false,\r\n            tweaked: false,\r\n            tempValue: this.variable.value\r\n        }\r\n    },\r\n    methods: {\r\n        mousedown(event) {\r\n            this.tempValue = this.variable.num()\r\n            if (!this.editmode) {\r\n                event.preventDefault()\r\n                this.tweakmode = true\r\n                this.tweaked = false\r\n            }\r\n        },\r\n        mouseup(event) {\r\n            if (this.tweakmode && !this.tweaked) {\r\n                this.editmode = true\r\n                this.tweakmode = false\r\n                this.$refs.input.focus()\r\n            }\r\n            this.tweakmode = false\r\n        },\r\n        mousemove(event) {\r\n            if (this.tweakmode && event.movementX!=0) {\r\n                this.tweaked = true\r\n                this.tempValue += event.movementX * this.step\r\n                this.updatevalue()\r\n            }\r\n        },\r\n        reset(event) {\r\n            this.editmode = false\r\n            this.tweakmode = false\r\n        },\r\n        menuclick(event) {\r\n            event.preventDefault()\r\n        },\r\n        updatevalue: throttle(10, function () {\r\n            this.variable.value = this.tempValue\r\n        })\r\n    },\r\n    mounted() {\r\n        this.$refs.input.addEventListener(\"mousedown\", this.mousedown)\r\n        addEventListener(\"mouseup\", this.mouseup)\r\n        addEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.addEventListener(\"blur\", this.reset)\r\n    },\r\n    beforeUnmount() {\r\n        this.$refs.input.removeEventListener(\"mousedown\", this.mousedown)\r\n        removeEventListener(\"mouseup\", this.mouseup)\r\n        removeEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.removeEventListener(\"blur\", this.reset)\r\n\r\n    }\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.optic_var_input {\r\n    display: inline-block;\r\n    position: relative;\r\n\r\n    input.draggable {\r\n        cursor: ew-resize;\r\n    }\r\n\r\n    &-editmode {\r\n        input.draggable {\r\n            cursor: text;\r\n            background: #333;\r\n        }\r\n    }\r\n\r\n    &-optimize {\r\n        input.draggable {\r\n            background-color: darkcyan;\r\n        }\r\n    }\r\n\r\n    &-menu {\r\n        z-index: 1;\r\n        position: absolute;\r\n\r\n        top: 100%;\r\n        left: 0;\r\n\r\n        width: max-content;\r\n        height: fit-content;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n}\r\n</style>","function asyncThrottle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    async function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout == null) {\r\n            timeout = 0\r\n            await fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nfunction throttle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n        if (timeout == null) {\r\n            fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nexport { throttle, asyncThrottle }","import { render } from \"./OpticVarInput.vue?vue&type=template&id=7c9c4ef9&scoped=true\"\nimport script from \"./OpticVarInput.vue?vue&type=script&lang=js\"\nexport * from \"./OpticVarInput.vue?vue&type=script&lang=js\"\n\nimport \"./OpticVarInput.vue?vue&type=style&index=0&id=7c9c4ef9&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7c9c4ef9\"]])\n\nexport default __exports__","import { render } from \"./OpticSurfaceComponent.vue?vue&type=template&id=6cdbd58e\"\nimport script from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","const ViewState = {\r\n    focusedSurface: null,\r\n    colorlist: [\r\n        \"red\", \"green\", \"blue\", \"yellow\", \"cyan\", \"magenta\"\r\n    ]\r\n}\r\n\r\n\r\n\r\nexport default ViewState","import { render } from \"./LensSheet.vue?vue&type=template&id=41ea9ed4\"\nimport script from \"./LensSheet.vue?vue&type=script&lang=js\"\nexport * from \"./LensSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"lens_plot ui_block\">\r\n        <div class=\"ui_block-header \">\r\n            <p>Plot</p>\r\n        </div>\r\n        <div class=\" ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"lens_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport PlotTrace from '@/optic/analyze/PlotTrace'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null,\r\n            ViewState: ViewState\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        \r\n        update: asyncThrottle(10, async function () {\r\n            if (this.ctx === null) return\r\n\r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await Promise.all(PlotTrace(this.system).map(x => x.array()))\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n            let ttl = 0\r\n\r\n            for (let surface of this.system.surfaces) {\r\n                ttl += surface.thickness.num()\r\n            }\r\n\r\n\r\n\r\n\r\n            let Rlist = []\r\n            let Rmax = 0\r\n            for (let j = 1; j < result.length; j++) {\r\n                let R = 0\r\n                for (let i = 0; i < result[0][0].length; i++) {\r\n                    let y = result[j][1][i]\r\n                    if (isNaN(y)) continue\r\n                    R = Math.max(R, Math.abs(y))\r\n                }\r\n                Rlist.push(R)\r\n                Rmax = Math.max(R, Rmax)\r\n            }\r\n\r\n            let scale = canvas.width / ttl * 0.9\r\n\r\n            scale = Math.min(scale, canvas.height / Rmax / 2 * 0.9)\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(-ttl / 2, 0)\r\n\r\n\r\n            ctx.lineWidth = 2 / scale\r\n\r\n            ctx.strokeStyle = \"#333\"\r\n            ctx.beginPath()\r\n            ctx.moveTo(0, 0)\r\n            ctx.lineTo(ttl, 0)\r\n            ctx.stroke()\r\n\r\n\r\n            ctx.strokeStyle = '#EEE'\r\n\r\n\r\n\r\n            const N = 50\r\n\r\n            let z0 = 0\r\n\r\n            ctx.fillStyle = '#111'\r\n\r\n\r\n            for (let j = 0; j < this.system.surfaces.length; j++) {\r\n                let surface = this.system.surfaces[j]\r\n                let R = Rlist[j]\r\n\r\n                let isSolid = j < this.system.surfaces.length - 1 && surface.material.index > 1\r\n\r\n                if (isSolid) {\r\n                    R = Math.max(R, Rlist[j + 1])\r\n                }\r\n\r\n                ctx.beginPath()\r\n                for (let i = 0; i <= N; i++) {\r\n                    let r = (i / N - 0.5) * 2 * R\r\n                    let z = surface.shape.surface(r)\r\n                    if (isNaN(r) || isNaN(z)) continue\r\n                    if (i == 0)\r\n                        ctx.moveTo(z0 + z, r)\r\n                    else\r\n                        ctx.lineTo(z0 + z, r)\r\n                }\r\n\r\n                if (isSolid) {\r\n                    let nextsurface = this.system.surfaces[j + 1]\r\n\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = -(i / N - 0.5) * 2 * R\r\n                        let z = nextsurface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        ctx.lineTo(z0 + z + surface.thickness.value, r)\r\n                    }\r\n\r\n                    ctx.closePath()\r\n                    ctx.fill()\r\n                }\r\n                ctx.stroke()\r\n\r\n\r\n                if (surface == ViewState.focusedSurface) {\r\n                    ctx.save()\r\n                    ctx.strokeStyle = \"orange\"\r\n                    ctx.lineWidth = 3 / scale\r\n                    ctx.beginPath()\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = (i / N - 0.5) * 2 * R\r\n                        let z = surface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        if (i == 0)\r\n                            ctx.moveTo(z0 + z, r)\r\n                        else\r\n                            ctx.lineTo(z0 + z, r)\r\n                    }\r\n                    ctx.stroke()\r\n                    ctx.restore()\r\n                }\r\n\r\n\r\n                z0 += surface.thickness.value\r\n            }\r\n\r\n\r\n            // Draw Rays\r\n            ctx.lineWidth = 1.5 / scale\r\n\r\n            for (let i = 0; i < result[0][0].length; i++) {\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                ctx.beginPath()\r\n                for (let j = 0; j < result.length; j++) {\r\n                    let y = result[j][1][i]\r\n                    let z = result[j][2][i]\r\n                    if (j == 0) ctx.moveTo(z, y)\r\n                    else ctx.lineTo(z, y)\r\n                }\r\n                ctx.stroke()\r\n            }\r\n\r\n        }, 50)\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        },\r\n        ViewState: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.lens_plot {\r\n    position: relative;\r\n    width: 500px;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport { toRaw } from \"vue\"\r\n\r\n\r\n/**\r\n * @param {OpticSystem} system \r\n * @param {tf.Tensor} raypos\r\n * @param {tf.Tensor} raydir \r\n*/\r\nfunction RayTrace(system, raypos, raydir) {\r\n    return tf.tidy(() => {\r\n\r\n        let result = []\r\n        result.push(raypos)\r\n\r\n        let n1 = 1\r\n        let z = tf.tensor(0)\r\n        for (let surface of system.surfaces) {\r\n            let n2 = Number(surface.material.index) || 1\r\n\r\n\r\n            raypos = surface.shape.trace(raypos.sub(tf.tensor([[0], [0], [1]]).mul(z)), raydir)\r\n            let normal = surface.shape.normal(raypos)\r\n\r\n\r\n            raydir = raydir.div(raydir.mul(raydir).sum(0).sqrt()).mul(n1)\r\n            normal = normal.mul(raydir.mul(normal).sum(0).sign())\r\n            let cos = raydir.mul(normal).sum(0)\r\n            let tangent2 = tf.sub(n1 ** 2, cos.mul(cos))\r\n            let displace = tf.sub(n2 ** 2, tangent2).sqrt().sub(tf.sub(n1 ** 2, tangent2).sqrt())\r\n            raydir = raydir.add(normal.mul(displace))\r\n\r\n\r\n            raypos = raypos.add(tf.tensor([[0], [0], [1]]).mul(z))\r\n            result.push(raypos)\r\n            n1 = n2\r\n\r\n            z = z.add(toRaw(surface.thickness.num()))\r\n        }\r\n\r\n\r\n        // result.push(raypos.add(raydir).arraySync())\r\n\r\n        return result\r\n    })\r\n}\r\n\r\n\r\nexport default RayTrace","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction PlotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 7\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n        for (let field of system.fields) {\r\n            let f = (i / N - 0.5) * 2\r\n            raypos.push(field.raypos(0, f, system))\r\n            raydir.push(field.raydir(0, f, system))\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    return RayTrace(system, raypos, raydir)\r\n}\r\n\r\nexport default PlotTrace","import { render } from \"./LensPlot.vue?vue&type=template&id=59899f99&scoped=true\"\nimport script from \"./LensPlot.vue?vue&type=script&lang=js\"\nexport * from \"./LensPlot.vue?vue&type=script&lang=js\"\n\nimport \"./LensPlot.vue?vue&type=style&index=0&id=59899f99&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-59899f99\"]])\n\nexport default __exports__","import OpticSystem from \"./OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\ntf.setBackend('cpu')\r\nconst system = new OpticSystem()\r\n\r\nexport default {\r\n    system\r\n}","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Field Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"content\">\r\n                <label for=\"diameter\">D=</label>\r\n                <OpticVarInput id=\"diameter\" :step=\"0.01\"\r\n                    :variable=\"system.pupilDiameter\" />\r\n\r\n                <label for=\"Z\">Z=</label>\r\n                <OpticVarInput id=\"Z\" :step=\"0.01\"\r\n                    :variable=\"system.pupilOffset\" />\r\n            </div>\r\n            <SheetUI :list=\"system.fields\"\r\n                :builder=\"buildField\">\r\n                <template #item=\"[field, i]\">\r\n                    <OpticFieldComponent :field=\"field\"\r\n                        :key=\"i\">\r\n                    </OpticFieldComponent>\r\n                </template>\r\n            </SheetUI>\r\n\r\n            <div class=\"content\">\r\n                <p>D=Entrance Diameter, Z=Distance to the\r\n                    pupil</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport OpticFieldComponent from './OpticFieldComponent.vue'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\nimport SheetUI from './common/SheetUI.vue'\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticFieldComponent,\r\n        OpticVarInput,\r\n        SheetUI\r\n    },\r\n    methods: {\r\n        buildField(i) {\r\n            return new OpticField()\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","<template>\r\n    <div>\r\n        <label for=\"angle\">angle=</label>\r\n        <OpticVarInput id=\"angle\" :step=\"0.02\"\r\n            :variable=\"field.angle\" />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        field: OpticField\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import { render } from \"./OpticFieldComponent.vue?vue&type=template&id=3c010f90\"\nimport script from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./FieldSheet.vue?vue&type=template&id=6f6c0f96\"\nimport script from \"./FieldSheet.vue?vue&type=script&lang=js\"\nexport * from \"./FieldSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"analyze_plot ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Spot Diagram</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"analyze_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport SpotTrace from '@/optic/analyze/SpotTrace'\r\nimport { toRaw } from 'vue'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport { stopForAxis } from '@tensorflow/tfjs-core/dist/ops/slice_util'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        update: asyncThrottle(10, async function () {\r\n            if (this.ctx === null) {\r\n                console.error('ctx not ready')\r\n            }\r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await SpotTrace(this.system).array()\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n\r\n            ctx.beginPath()\r\n            let ymax = result[1][0]\r\n            let ymin = result[1][0]\r\n\r\n\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                let y = result[1][i]\r\n                if (isNaN(y)) continue\r\n                ymax = Math.max(y, ymax)\r\n                ymin = Math.min(y, ymin)\r\n            }\r\n\r\n            let scale = canvas.height / (ymax - ymin + 2) * 0.8\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(0, -(ymax + ymin) / 2)\r\n            ctx.lineWidth = 1 / scale\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                ctx.beginPath()\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                let x = result[0][i]\r\n                let y = result[1][i]\r\n                ctx.rect(x - 1 / scale, y - 1 / scale, 2 / scale, 2 / scale)\r\n                ctx.stroke()\r\n            }\r\n        })\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.analyze_plot {\r\n    position: relative;\r\n    width: 200px;\r\n    height: 100%;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction SpotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 5\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n\r\n\r\n        let f = i / N\r\n\r\n        let N2 = f * 16 + 1\r\n        for (let j = 0; j < N2; j++) {\r\n\r\n            let f2 = j / N2\r\n\r\n            let fx = f * Math.cos(f2 * Math.PI * 2)\r\n            let fy = f * Math.sin(f2 * Math.PI * 2)\r\n\r\n            for (let field of system.fields) {\r\n                raypos.push(field.raypos(fx, fy, system))\r\n                raydir.push(field.raydir(fx, fy, system))\r\n            }\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    let result = RayTrace(system, raypos, raydir)\r\n    let spot = result[result.length - 1]\r\n\r\n    return spot\r\n}\r\n\r\nexport default SpotTrace","import { render } from \"./AnalyzePlot.vue?vue&type=template&id=0dfd1afe&scoped=true\"\nimport script from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\nexport * from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\n\nimport \"./AnalyzePlot.vue?vue&type=style&index=0&id=0dfd1afe&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0dfd1afe\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"optimize_wizard ui_block\">\r\n        <div class=\"ui_block-header\">Optimizer</div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\"\r\n                    name=\"updateOnSystemChange\"\r\n                    id=\"updateOnSystemChange\"\r\n                    v-model=\"updateOnSystemChange\">\r\n                <label for=\"updateOnSystemChange\">Update\r\n                    merit on\r\n                    change</label>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <p>Current Merit: {{\r\n                        merit.toPrecision(6)\r\n                }}\r\n                </p>\r\n\r\n            </div>\r\n            <div class=\"row content\">\r\n                <button @click=\"updateMerit\">Calculate\r\n                    Current</button>\r\n\r\n                <button @click=\"stop\"\r\n                    v-if=\"this.iterate\">Stop!</button>\r\n                <button @click=\"optimize\"\r\n                    v-else>Optimize!</button>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <label for=\"maxIteration\">Max:</label>\r\n                <input type=\"number\" name=\"maxIteration\"\r\n                    id=\"maxIteration\"\r\n                    v-model=\"maxIteration\">\r\n                <p>Iterations: {{ iterations }}</p>\r\n            </div>\r\n\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\" name=\"updateView\"\r\n                    id=\"updateView\" v-model=\"updateView\">\r\n                <label for=\"updateView\">Update\r\n                    view</label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport Optimize from '@/optic/analyze/Optimize'\r\nimport Merit from '@/optic/analyze/Merit'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            merit: 0,\r\n            iterate: null,\r\n            apply: null,\r\n            iterations: 0,\r\n            maxIteration: 20,\r\n            timeout: null,\r\n            updateOnSystemChange: true,\r\n            updateView: false\r\n        }\r\n    },\r\n    methods: {\r\n        updateMerit: throttle(10, function () {\r\n            this.merit = Merit(this.system).arraySync()[0]\r\n        }),\r\n        async optimize() {\r\n            this.iterations = 0\r\n            let [iterate, apply] = await Optimize(this.system)\r\n            this.iterate = iterate\r\n            this.apply = apply\r\n            this.update()\r\n        },\r\n        update() {\r\n            if (this.timeout) clearTimeout(this.timeout)\r\n            if (this.iterations >= this.maxIteration) this.stop()\r\n            else if (this.iterate) {\r\n                let vm = this\r\n                this.iterate().then((merit) => {\r\n                    this.merit = merit\r\n                    if (this.updateView) this.apply()\r\n                    vm.timeout = setTimeout(() => {\r\n                        vm.iterations += 1\r\n                        vm.update()\r\n                    }, 0)\r\n                })\r\n            }\r\n        },\r\n        stop() {\r\n            if (this.apply) {\r\n                this.system.update += 1\r\n                this.apply()\r\n                this.apply = null\r\n            }\r\n            this.updateMerit()\r\n            this.iterate = null\r\n            clearTimeout(this.timeout)\r\n            this.timeout = null\r\n        }\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                if (this.updateOnSystemChange && !this.iterate) {\r\n                    this.updateMerit()\r\n                }\r\n            },\r\n            deep: true\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.optimize_wizard {\r\n    max-width: 300px;\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction Merit(system) {\r\n    return tf.tidy(() => {\r\n\r\n        let merit = tf.tensor([0])\r\n\r\n        for (let field of system.fields) {\r\n            merit = tf.tidy(() => {\r\n                const raypos1 = []\r\n                const raydir1 = []\r\n                const N = 3\r\n\r\n                // Go through every field and create rays\r\n                for (let i = 0; i <= N; i++) {\r\n                    const f = i / N\r\n                    const N2 = 3 * f + 1\r\n\r\n                    for (let j = 0; j <= N2; j++) {\r\n                        const f2 = j / N2 - 0.5\r\n                        const fx = f * Math.cos(f2 * Math.PI)\r\n                        const fy = f * Math.sin(f2 * Math.PI)\r\n                        raypos1.push(field.raypos(fx, fy, system))\r\n                        raydir1.push(field.raydir(fx, fy, system))\r\n                    }\r\n                }\r\n\r\n                const raypos = tf.tensor(raypos1).transpose()\r\n                const raydir = tf.tensor(raydir1).transpose()\r\n\r\n                const result = RayTrace(system, raypos, raydir)\r\n                const spot = result[result.length - 1]\r\n\r\n                const delta = spot.sub(spot.gather(0, 1).expandDims(1))\r\n\r\n                const error = delta.mul(delta)\r\n                const mask = error.isNaN().logicalNot()\r\n                const maxerror = error.where(mask, 0).max().add(1e5)\r\n                return merit.add(error.where(mask, maxerror).sum())\r\n            })\r\n        }\r\n\r\n        return merit\r\n    })\r\n}\r\n\r\nexport default Merit","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport Merit from \"./Merit\"\r\nimport { toRaw } from \"vue\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nasync function Optimize(system) {\r\n\r\n\r\n    let variables = []\r\n    variables.push(system.pupilOffset)\r\n    for (let surface of system.surfaces) {\r\n        variables.push(surface.shape.curvature)\r\n        variables.push(surface.thickness)\r\n    }\r\n\r\n    variables = variables.filter(x => x.optimize)\r\n\r\n    let rawVariables = variables.map(toRaw)\r\n    let x0 = rawVariables.map(x => x.num())\r\n\r\n\r\n    async function evaluate(x) {\r\n        rawVariables.map((variable, i) => {\r\n            variable.value = x[i]\r\n        })\r\n        return (await Merit(system).array())[0]\r\n    }\r\n\r\n    async function evaluateAll(seeds, scores) {\r\n        for (let i = 0; i < seeds.length; i++) {\r\n            scores[i] = await evaluate(seeds[i])\r\n        }\r\n    }\r\n\r\n    const seeds = [x0]\r\n\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 0.01))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n\r\n    const N = seeds.length\r\n\r\n\r\n    const scores = []\r\n    const newScores = []\r\n    const newSeeds = []\r\n    await evaluateAll(seeds, scores)\r\n\r\n    let bestScore = scores[0]\r\n    let bestSeed = seeds[0]\r\n\r\n\r\n    async function iterate(F = 0.9) {\r\n        for (let i = 0; i < N; i++) {\r\n            const a = Math.floor(Math.random() * N)\r\n            const b = Math.floor(Math.random() * N)\r\n            const c = Math.floor(Math.random() * N)\r\n            const z = Math.floor(Math.random() * N)\r\n\r\n            const A = seeds[a]\r\n            const B = seeds[b]\r\n            const C = seeds[c]\r\n\r\n            newSeeds[i] = seeds[i].map((x, j) => {\r\n                if (j !== z && Math.random() < 0.3) return x\r\n                return A[j] + (B[j] - C[j]) * F\r\n            })\r\n        }\r\n\r\n        await evaluateAll(newSeeds, newScores)\r\n\r\n        for (let i = 0; i < N; i++) {\r\n            if (!isNaN(newScores[i]) && newScores[i] < scores[i]) {\r\n                scores[i] = newScores[i]\r\n                seeds[i] = newSeeds[i]\r\n\r\n                if (isNaN(bestScore) || scores[i] < bestScore) {\r\n                    bestScore = scores[i]\r\n                    bestSeed = seeds[i]\r\n                }\r\n            }\r\n        }\r\n\r\n        return bestScore\r\n    }\r\n\r\n    function apply() {\r\n        rawVariables.map((x, i) => {\r\n            x.value = null\r\n        })\r\n        variables.map((x, i) => {\r\n            x.value = bestSeed[i]\r\n        })\r\n    }\r\n\r\n    return [iterate.bind(this), apply.bind(this)]\r\n}\r\n\r\nexport default Optimize","import { render } from \"./OptimizeWizard.vue?vue&type=template&id=2fd3bb79&scoped=true\"\nimport script from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\nexport * from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\n\nimport \"./OptimizeWizard.vue?vue&type=style&index=0&id=2fd3bb79&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2fd3bb79\"]])\n\nexport default __exports__","function debounce(time, fun) {\r\n\r\n    let timeout = null\r\n    let thisarg = null\r\n    let args = []\r\n\r\n    function delayed() {\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout) {\r\n            clearTimeout(timeout)\r\n        }\r\n\r\n        timeout = setTimeout(function () {\r\n            fun.apply(thisarg, args)\r\n            timeout = null\r\n        }, time)\r\n    }\r\n    return delayed\r\n}\r\n\r\n\r\nexport { debounce }","import { render } from \"./App.vue?vue&type=template&id=9c94eec8&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=9c94eec8&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-9c94eec8\"]])\n\nexport default __exports__","\r\nimport { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './style/index.scss'\r\ncreateApp(App).mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkoptictool\"] = self[\"webpackChunkoptictool\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(3675); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","onClick","$options","_hoisted_5","stateHead","state","length","this","_hoisted_6","_createVNode","_component_LensPlot","system","$data","_component_AnalyzePlot","_hoisted_7","_component_LensSheet","_component_FieldSheet","_component_OptimizeWizard","_hoisted_8","_component_SheetUI","list","$props","surfaces","builder","item","surface","i","_createBlock","_component_OpticSurfaceComponent","key","compress","str","replaceAll","decompress","Serializer","serializable","classname","param2v","serializer","Class","classdefs","console","error","name","classnames","v2param","serialize","object","JSON","stringify","_serialize","Array","map","x","Object","obj","constructor","_","p2v","deserialize","_deserialize","parse","classdef","v2p","OpticMaterial","index","OpticVar","value","optimize","num","Number","isNaN","OpticShapeSpherical","curvature","trace","raypos","raydir","c","tf","l","gather","div","mul","A","sum","B","sub","C","sqrt","dispose","add","normal","p","n","r","r2","Math","OpticSurface","thickness","shape","material","OpticField","angle","fx","fy","R","pupilDiameter","PZ","pupilOffset","a","z","y","sin","PI","cos","OpticSystem","fields","_TransitionGroup","tag","_Fragment","_renderSlot","_ctx","props","Function","methods","addItem","splice","delItem","getid","toRaw","undefined","_id_","some","__exports__","for","_component_OpticVarInput","id","type","step","variable","min","max","toPrecision","ref","onMousedown","asyncThrottle","time","fun","timeout","dirty","thisarg","args","async","delayed","arguments","apply","setTimeout","throttle","data","editmode","tweakmode","tweaked","tempValue","mousedown","event","preventDefault","mouseup","$refs","input","focus","mousemove","movementX","updatevalue","reset","menuclick","mounted","addEventListener","beforeUnmount","removeEventListener","components","OpticVarInput","ViewState","focusedSurface","colorlist","OpticSurfaceComponent","SheetUI","buildSurface","hover","RayTrace","result","push","n1","n2","sign","tangent2","displace","PlotTrace","N","field","f","transpose","canvas","ctx","resize","rect","container","getBoundingClientRect","width","height","update","Promise","all","array","resetTransform","clearRect","translate","ttl","Rlist","Rmax","j","abs","scale","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","z0","fillStyle","isSolid","nextsurface","closePath","fill","save","restore","watch","handler","deep","getContext","unmounted","_component_OpticFieldComponent","OpticFieldComponent","buildField","SpotTrace","N2","f2","spot","ymax","ymin","iterate","_hoisted_9","_hoisted_10","_hoisted_11","Merit","merit","raypos1","raydir1","delta","expandDims","mask","logicalNot","maxerror","where","Optimize","variables","filter","rawVariables","x0","evaluate","evaluateAll","seeds","scores","random","newScores","newSeeds","bestScore","bestSeed","F","floor","b","bind","iterations","maxIteration","updateOnSystemChange","updateView","updateMerit","arraySync","clearTimeout","stop","vm","then","debounce","optic","no_record","LensSheet","LensPlot","FieldSheet","AnalyzePlot","OptimizeWizard","undo","load","redo","open","document","createElement","onchange","reader","FileReader","readAsText","files","onload","e","target","click","filename","contents","blob","Blob","File","createEvent","download","href","window","URL","createObjectURL","dataset","downloadurl","join","render","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","amdD","Error","amdO","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","keys","every","getter","__esModule","d","definition","o","defineProperty","enumerable","get","g","globalThis","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","forEach","__webpack_exports__"],"sourceRoot":""}