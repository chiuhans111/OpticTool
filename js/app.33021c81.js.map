{"version":3,"file":"js/app.33021c81.js","mappings":"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","sources":["webpack://optictool/./src/App.vue","webpack://optictool/./src/components/LensSheet.vue","webpack://optictool/./src/optic/material/OpticMaterial.js","webpack://optictool/./src/optic/OpticVar.js","webpack://optictool/./src/optic/shapes/OpticShapeSpherical.js","webpack://optictool/./src/optic/OpticSurface.js","webpack://optictool/./src/optic/OpticField.js","webpack://optictool/./src/optic/OpticSystem.js","webpack://optictool/./src/components/OpticSurfaceComponent.vue","webpack://optictool/./src/components/OpticVarInput.vue","webpack://optictool/./src/scripts/throttle.js","webpack://optictool/./src/components/OpticVarInput.vue?0abe","webpack://optictool/./src/components/OpticSurfaceComponent.vue?b88a","webpack://optictool/./src/components/ViewControl.js","webpack://optictool/./src/components/LensSheet.vue?c9b6","webpack://optictool/./src/components/LensPlot.vue","webpack://optictool/./src/optic/analyze/RayTrace.js","webpack://optictool/./src/optic/analyze/PlotTrace.js","webpack://optictool/./src/components/LensPlot.vue?38c6","webpack://optictool/./src/optic/index.js","webpack://optictool/./src/optic/Serializer.js","webpack://optictool/./src/components/FieldSheet.vue","webpack://optictool/./src/components/OpticFieldComponent.vue","webpack://optictool/./src/components/OpticFieldComponent.vue?f754","webpack://optictool/./src/components/FieldSheet.vue?7e0e","webpack://optictool/./src/components/AnalyzePlot.vue","webpack://optictool/./src/optic/analyze/SpotTrace.js","webpack://optictool/./src/components/AnalyzePlot.vue?afb0","webpack://optictool/./src/components/OptimizeWizard.vue","webpack://optictool/./src/optic/analyze/Merit.js","webpack://optictool/./src/optic/analyze/Optimize.js","webpack://optictool/./src/components/OptimizeWizard.vue?f450","webpack://optictool/./src/scripts/debounce.js","webpack://optictool/./src/App.vue?7ccd","webpack://optictool/./src/main.js","webpack://optictool/webpack/bootstrap","webpack://optictool/webpack/runtime/amd define","webpack://optictool/webpack/runtime/amd options","webpack://optictool/webpack/runtime/chunk loaded","webpack://optictool/webpack/runtime/compat get default export","webpack://optictool/webpack/runtime/define property getters","webpack://optictool/webpack/runtime/global","webpack://optictool/webpack/runtime/hasOwnProperty shorthand","webpack://optictool/webpack/runtime/make namespace object","webpack://optictool/webpack/runtime/node module decorator","webpack://optictool/webpack/runtime/jsonp chunk loading","webpack://optictool/webpack/startup"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"row\">\r\n      <h2>Optic Tool </h2>\r\n      <div></div>\r\n      <button @click=\"open\">Open</button>\r\n      <button @click=\"save\">Save</button>\r\n      <div></div>\r\n      <button @click=\"undo\">Undo\r\n        {{ this.stateHead - 1 }}</button>\r\n      <button @click=\"redo\">Redo\r\n        {{ this.state.length - this.stateHead }}</button>\r\n    </div>\r\n    <div class=\"row top_row\">\r\n      <LensPlot :system=\"system\"></LensPlot>\r\n      <AnalyzePlot :system=\"system\"></AnalyzePlot>\r\n    </div>\r\n    <div class=\"row\">\r\n      <LensSheet :system=\"system\"></LensSheet>\r\n      <FieldSheet :system=\"system\"></FieldSheet>\r\n      <OptimizeWizard :system=\"system\"></OptimizeWizard>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"content\">\r\n        <h3>About this project</h3>\r\n        <p>Developer: <a\r\n            href=\"https://chiuhans111.github.io\">Hans\r\n            Chiu</a></p>\r\n        <p>Project repo: <a\r\n            href=\"https://github.com/chiuhans111/OpticTool\">https://github.com/chiuhans111/OpticTool</a>\r\n        </p>\r\n      </div>\r\n      <div class=\"content\">\r\n        <h3>How to use?</h3>\r\n        <p>Drag the input box to modify value.</p>\r\n        <p>Click the input box to edit and set optimization\r\n          variable.</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LensSheet from './components/LensSheet.vue'\r\nimport LensPlot from './components/LensPlot.vue'\r\nimport optic from './optic'\r\nimport serializer from './optic/Serializer'\r\nimport FieldSheet from './components/FieldSheet.vue'\r\nimport AnalyzePlot from './components/AnalyzePlot.vue'\r\nimport OptimizeWizard from './components/OptimizeWizard.vue'\r\nimport { throttle } from './scripts/throttle'\r\nimport { debounce } from './scripts/debounce'\r\nimport { toRaw } from 'vue'\r\nexport default {\r\n  name: 'App',\r\n  data() {\r\n    return {\r\n      system: optic.system,\r\n      state: [],\r\n      no_record: false,\r\n      stateHead: 0\r\n    }\r\n  },\r\n  components: {\r\n    LensSheet,\r\n    LensPlot,\r\n    FieldSheet,\r\n    AnalyzePlot,\r\n    OptimizeWizard\r\n  },\r\n  mounted() {\r\n    this.push()\r\n  },\r\n  methods: {\r\n    undo() {\r\n      this.no_record = true\r\n      if (this.stateHead > 1)\r\n        this.stateHead--\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    redo() {\r\n      this.no_record = true\r\n      if (this.stateHead < this.state.length)\r\n        this.stateHead++\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    load(str) {\r\n      this.system = serializer.deserialize(str)\r\n    },\r\n    push: debounce(200, throttle(500, function () {\r\n      this.state.splice(this.stateHead)\r\n      let str = serializer.serialize(toRaw(this.system))\r\n      if (this.state.length == 0 || str !== this.state[this.state.length - 1]) {\r\n        this.state.push(str)\r\n        this.stateHead += 1\r\n      }\r\n    })),\r\n    open() {\r\n      let a = document.createElement('input')\r\n      a.type = 'file'\r\n      let vm = this\r\n      a.onchange = function () {\r\n        const reader = new FileReader()\r\n        reader.readAsText(a.files[0], \"UTF-8\")\r\n        reader.onload = function (e) {\r\n          vm.load(e.target.result)\r\n          console.log(e.target.result)\r\n        }\r\n      }\r\n      a.click()\r\n\r\n\r\n    },\r\n    save() {\r\n      let filename = \"lens.json\"\r\n      var contents = serializer.serialize(toRaw(this.system))\r\n      var blob = new Blob([contents], { type: 'text/plain' })\r\n      var file = new File([blob], filename, { type: \"text/plain\" })\r\n      let a = document.createElement('a')\r\n      let e = document.createEvent('MouseEvents')\r\n      a.download = filename\r\n      a.href = window.URL.createObjectURL(blob)\r\n      a.dataset.downloadurl = ['text/obj', a.download, a.href].join(':')\r\n      a.click()\r\n    }\r\n  },\r\n  watch: {\r\n    system: {\r\n      handler() {\r\n        if (!this.no_record)\r\n          this.push()\r\n        this.no_record = false\r\n      },\r\n      deep: true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.top_row>div {\r\n  height: 450px;\r\n}\r\n</style>\r\n","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Lens Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n\r\n            <div class=\"ui_sheet-row\"\r\n                v-for=\"surface, i in system.surfaces\"\r\n                :key=\"i\" @mousedown=\"hover(surface)\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button\r\n                            @click=\"system.surfaces.splice(i, 1)\">Del</button>\r\n                        <button\r\n                            @click=\"addSurface(i)\">Add</button>\r\n                    </div>\r\n                    <OpticSurfaceComponent\r\n                        :surface=\"surface\">\r\n                    </OpticSurfaceComponent>\r\n                </div>\r\n            </div>\r\n            <div class=\"ui_sheet-row\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button\r\n                            @click=\"addSurface(system.surfaces.length)\">Add</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"content\">\r\n                <p>t=thickness, c=curvature (1/R), n=index\r\n                    of\r\n                    refraction</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport OpticSurfaceComponent from './OpticSurfaceComponent.vue'\r\nimport ViewState from './ViewControl'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticSurfaceComponent\r\n    },\r\n    methods: {\r\n        addSurface(i) {\r\n            this.system.surfaces.splice(i, 0, new OpticSurface())\r\n        },\r\n        hover(surface) {\r\n            ViewState.focusedSurface = surface\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","class OpticMaterial {\r\n    index = 1.5\r\n    _SP = [\"index\"]\r\n    constructor(index) {\r\n        this.index = index\r\n    }\r\n\r\n}\r\n\r\nexport default OpticMaterial","class OpticVar {\r\n    value = 0\r\n    optimize = false\r\n    constructor(value) {\r\n        this.value = value || 0\r\n    }\r\n\r\n    _SP = [\"value\", \"optimize\"]\r\n}\r\n\r\nexport default OpticVar","import * as tf from \"@tensorflow/tfjs\"\r\nimport { toRaw } from \"vue\"\r\nimport OpticVar from \"../OpticVar\"\r\n\r\nfunction ensurevalue(v) {\r\n    if (v instanceof tf.Tensor) {\r\n        return v.arraySync()[0]\r\n    }\r\n    else return v\r\n}\r\n\r\nclass OpticShapeSpherical {\r\n    curvature = new OpticVar(0)\r\n\r\n    _SP = [\"curvature\"]\r\n\r\n    constructor(curvature) {\r\n        this.curvature.value = curvature\r\n    }\r\n\r\n    /** Find intersection position\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @param {tf.Tensor} raydir direction of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} intersection position\r\n    */\r\n    trace(raypos, raydir) {\r\n        const c = toRaw(this.curvature.value)\r\n        return tf.tidy(() => {\r\n            let l = raypos.gather(2).div(raydir.gather(2)).mul(-1)\r\n\r\n            if (ensurevalue(c) != 0) {\r\n\r\n                const A = raydir.mul(raydir).sum(0).mul(c)\r\n                const B = raypos.mul(raydir).sum(0).mul(c).sub(raydir.gather(2)).mul(2)\r\n                const C = raypos.mul(raypos).sum(0).mul(c).sub(raypos.gather(2).mul(2))\r\n                l = B.mul(-1).sub(B.mul(B).sub(A.mul(C).mul(4)).sqrt()).div(A).div(2)\r\n                A.dispose()\r\n                B.dispose()\r\n                C.dispose()\r\n            }\r\n\r\n            return raypos.add(raydir.mul(l))\r\n        })\r\n    }\r\n\r\n    /** Find the normal vector\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} normal vector at given position\r\n    */\r\n    normal(raypos) {\r\n        const c = toRaw(this.curvature.value)\r\n\r\n        return tf.tidy(() => {\r\n            let p = raypos.mul(0).add(tf.tensor([[0], [0], [-1]]))\r\n            if (ensurevalue(c) != 0) {\r\n                let n = raypos.sub(tf.tensor([[0], [0], [1]]).div(c))\r\n                p = n.div(n.mul(n).sum(0).sqrt())\r\n            }\r\n\r\n            return p\r\n        })\r\n    }\r\n\r\n\r\n    surface(r) {\r\n        const r2 = r ** 2\r\n        return r2 * this.curvature.value / (1 + Math.sqrt(1 - r2 * this.curvature.value ** 2))\r\n    }\r\n}\r\n\r\nexport default OpticShapeSpherical","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport OpticShapeSpherical from \"./shapes/OpticShapeSpherical\"\r\n\r\nclass OpticSurface {\r\n    thickness = new OpticVar(0)\r\n    shape = new OpticShapeSpherical(0)\r\n    material = new OpticMaterial(1.5)\r\n    _SP = [\"thickness\", \"shape\", \"material\"]\r\n\r\n\r\n    constructor(thickness, curvature, material) {\r\n        this.thickness.value = thickness || this.thickness.value\r\n        this.shape.curvature.value = curvature || this.shape.curvature.value\r\n        this.material = material || this.material\r\n    }\r\n\r\n}\r\n\r\n\r\nexport default OpticSurface","import OpticSystem from \"./OpticSystem\"\r\nimport OpticVar from \"./OpticVar\"\r\nclass OpticField {\r\n    angle = new OpticVar(0)\r\n\r\n    _SP = [\"angle\"]\r\n\r\n    constructor(angle) {\r\n        this.angle.value = angle || this.angle.value\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Number} f \r\n     * @param {OpticSystem} system \r\n     * @returns \r\n     */\r\n    raypos(fx, fy, system) {\r\n        const R = system.pupilDiameter.value / 2\r\n        const PZ = system.pupilOffset.value\r\n        const a = this.angle.value\r\n\r\n        const z = -1\r\n        const x = fx * R\r\n        const y = fy * R + (PZ - z) * Math.sin(a / 180 * Math.PI)\r\n        return [x, y, z]\r\n    }\r\n\r\n    raydir(fx, fy) {\r\n        return [0, -Math.sin(this.angle.value / 180 * Math.PI), Math.cos(this.angle.value / 180 * Math.PI)]\r\n    }\r\n}\r\n\r\nexport default OpticField","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticField from \"./OpticField\"\r\nimport OpticSurface from \"./OpticSurface\"\r\nimport OpticVar from \"./OpticVar\"\r\n\r\nclass OpticSystem {\r\n    surfaces = [\r\n        new OpticSurface(3, 0.066667, new OpticMaterial(1.515)),\r\n        new OpticSurface(4, -0.01316, new OpticMaterial(1)),\r\n        new OpticSurface(1.5, -0.05882, new OpticMaterial(1.6438)),\r\n        new OpticSurface(2.5, 0.0625, new OpticMaterial(1)),\r\n        new OpticSurface(3, 0.022727, new OpticMaterial(1.515)),\r\n        new OpticSurface(40, -0.07143, new OpticMaterial(1)),\r\n        new OpticSurface(0, 0, new OpticMaterial(1))\r\n    ]\r\n\r\n    fields = [\r\n        new OpticField(0),\r\n        new OpticField(10),\r\n        new OpticField(20),\r\n    ]\r\n\r\n    pupilDiameter = new OpticVar(10)\r\n    pupilOffset = new OpticVar(10)\r\n\r\n    update = 0\r\n\r\n    _SP = [\"surfaces\", \"fields\", \"pupilDiameter\", \"pupilOffset\"]\r\n}\r\n\r\n\r\nexport default OpticSystem","<template>\r\n    <div>\r\n        <label for=\"curvature\">c=</label>\r\n        <OpticVarInput id=\"curvature\" type=\"number\"\r\n            :step=\"0.0001\"\r\n            :variable=\"surface.shape.curvature\" />\r\n        <span>, </span>\r\n        <label for=\"thickness\">t=</label>\r\n        <OpticVarInput id=\"thickness\" :step=\"0.01\"\r\n            :variable=\"surface.thickness\" />\r\n\r\n        <span>, </span>\r\n        <label for=\"material\">n=</label>\r\n        <input id=\"material\" type=\"number\" step=\"0.01\"\r\n            min=\"1\" max=\"99\"\r\n            v-model.number=\"surface.material.index\">\r\n\r\n        <span> (R={{ (1 /\r\n                surface.shape.curvature.value).toPrecision(4)\r\n        }})\r\n        </span>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticVarInput from './OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        surface: OpticSurface\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","<template>\r\n    <div class=\"optic_var_input\" :class=\"{\r\n        'optic_var_input-editmode': editmode,\r\n        'optic_var_input-optimize': variable.optimize\r\n    }\">\r\n        <input class=\"draggable\" ref=\"input\" type=\"number\"\r\n            v-model=\"variable.value\" :step=\"step\">\r\n\r\n        <div ref=\"menu\" class=\"optic_var_input-menu\"\r\n            v-if=\"editmode\" @mousedown=\"menuclick\">\r\n            <div class=\"ui_block\">\r\n                <div class=\"ui_block-body\">\r\n                    <div class=\"content\">\r\n                        <input type=\"checkbox\"\r\n                            name=\"optimize\" id=\"optimize\"\r\n                            v-model=\"variable.optimize\">\r\n                        <label\r\n                            for=\"optimize\">Optimize</label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticVar from '@/optic/OpticVar'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        variable: OpticVar,\r\n        step: Number\r\n    },\r\n    data() {\r\n        return {\r\n            editmode: false,\r\n            tweakmode: false,\r\n            tweaked: false,\r\n            tempValue: this.variable.value\r\n        }\r\n    },\r\n    methods: {\r\n        mousedown(event) {\r\n            this.tempValue = this.variable.value\r\n            if (!this.editmode) {\r\n                event.preventDefault()\r\n                this.tweakmode = true\r\n                this.tweaked = false\r\n            }\r\n        },\r\n        mouseup(event) {\r\n            if (this.tweakmode && !this.tweaked) {\r\n                this.editmode = true\r\n                this.tweakmode = false\r\n                this.$refs.input.focus()\r\n            }\r\n            this.tweakmode = false\r\n        },\r\n        mousemove(event) {\r\n            if (this.tweakmode) {\r\n                this.tweaked = true\r\n                this.tempValue += event.movementX * this.step\r\n                this.updatevalue()\r\n            }\r\n        },\r\n        reset(event) {\r\n            this.editmode = false\r\n            this.tweakmode = false\r\n        },\r\n        menuclick(event) {\r\n            event.preventDefault()\r\n        },\r\n        updatevalue: throttle(10, function () {\r\n            this.variable.value = this.tempValue\r\n        })\r\n    },\r\n    mounted() {\r\n        this.$refs.input.addEventListener(\"mousedown\", this.mousedown)\r\n        addEventListener(\"mouseup\", this.mouseup)\r\n        addEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.addEventListener(\"blur\", this.reset)\r\n    },\r\n    beforeUnmount() {\r\n        this.$refs.input.removeEventListener(\"mousedown\", this.mousedown)\r\n        removeEventListener(\"mouseup\", this.mouseup)\r\n        removeEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.removeEventListener(\"blur\", this.reset)\r\n\r\n    }\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.optic_var_input {\r\n    display: inline-block;\r\n    position: relative;\r\n\r\n    input.draggable {\r\n        cursor: ew-resize;\r\n    }\r\n\r\n    &-editmode {\r\n        input.draggable {\r\n            cursor: text;\r\n            background: #333;\r\n        }\r\n    }\r\n\r\n    &-optimize {\r\n        input.draggable {\r\n            background-color: darkcyan;\r\n        }\r\n    }\r\n\r\n    &-menu {\r\n        z-index: 1;\r\n        position: absolute;\r\n\r\n        top: 100%;\r\n        left: 0;\r\n\r\n        width: max-content;\r\n        height: fit-content;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n}\r\n</style>","function asyncThrottle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    async function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout == null) {\r\n            timeout = 0\r\n            await fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nfunction throttle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n        if (timeout == null) {\r\n            fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nexport { throttle, asyncThrottle }","import { render } from \"./OpticVarInput.vue?vue&type=template&id=6ddc2af9&scoped=true\"\nimport script from \"./OpticVarInput.vue?vue&type=script&lang=js\"\nexport * from \"./OpticVarInput.vue?vue&type=script&lang=js\"\n\nimport \"./OpticVarInput.vue?vue&type=style&index=0&id=6ddc2af9&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6ddc2af9\"]])\n\nexport default __exports__","import { render } from \"./OpticSurfaceComponent.vue?vue&type=template&id=03fde7f8\"\nimport script from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","const ViewState = {\r\n    focusedSurface: null,\r\n    colorlist: [\r\n        \"red\", \"green\", \"blue\", \"yellow\", \"cyan\", \"magenta\"\r\n    ]\r\n}\r\n\r\n\r\n\r\nexport default ViewState","import { render } from \"./LensSheet.vue?vue&type=template&id=d2ea5c5e\"\nimport script from \"./LensSheet.vue?vue&type=script&lang=js\"\nexport * from \"./LensSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"lens_plot ui_block\">\r\n        <div class=\"ui_block-header \">\r\n            <p>Plot</p>\r\n        </div>\r\n        <div class=\" ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"lens_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport PlotTrace from '@/optic/analyze/PlotTrace'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null,\r\n            ViewState: ViewState\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        update: asyncThrottle(10, async function () {\r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await Promise.all(PlotTrace(this.system).map(x=>x.array()))\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n            let ttl = 0\r\n\r\n            for (let surface of this.system.surfaces) {\r\n                ttl += surface.thickness.value\r\n            }\r\n\r\n\r\n\r\n\r\n            let Rlist = []\r\n            let Rmax = 0\r\n            for (let j = 1; j < result.length; j++) {\r\n                let R = 0\r\n                for (let i = 0; i < result[0][0].length; i++) {\r\n                    let y = result[j][1][i]\r\n                    if (isNaN(y)) continue\r\n                    R = Math.max(R, Math.abs(y))\r\n                }\r\n                Rlist.push(R)\r\n                Rmax = Math.max(R, Rmax)\r\n            }\r\n\r\n            let scale = canvas.width / ttl * 0.9\r\n\r\n            scale = Math.min(scale, canvas.height / Rmax / 2 * 0.9)\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(-ttl / 2, 0)\r\n\r\n\r\n            ctx.lineWidth = 2 / scale\r\n\r\n            ctx.strokeStyle = \"#333\"\r\n            ctx.beginPath()\r\n            ctx.moveTo(0, 0)\r\n            ctx.lineTo(ttl, 0)\r\n            ctx.stroke()\r\n\r\n\r\n            ctx.strokeStyle = '#EEE'\r\n\r\n\r\n\r\n            const N = 50\r\n\r\n            let z0 = 0\r\n\r\n            ctx.fillStyle = '#111'\r\n\r\n\r\n            for (let j = 0; j < this.system.surfaces.length; j++) {\r\n                let surface = this.system.surfaces[j]\r\n                let R = Rlist[j]\r\n\r\n                let isSolid = j < this.system.surfaces.length - 1 && surface.material.index > 1\r\n\r\n                if (isSolid) {\r\n                    R = Math.max(R, Rlist[j + 1])\r\n                }\r\n\r\n                ctx.beginPath()\r\n                for (let i = 0; i <= N; i++) {\r\n                    let r = (i / N - 0.5) * 2 * R\r\n                    let z = surface.shape.surface(r)\r\n                    if (isNaN(r) || isNaN(z)) continue\r\n                    if (i == 0)\r\n                        ctx.moveTo(z0 + z, r)\r\n                    else\r\n                        ctx.lineTo(z0 + z, r)\r\n                }\r\n\r\n                if (isSolid) {\r\n                    let nextsurface = this.system.surfaces[j + 1]\r\n\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = -(i / N - 0.5) * 2 * R\r\n                        let z = nextsurface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        ctx.lineTo(z0 + z + surface.thickness.value, r)\r\n                    }\r\n\r\n                    ctx.closePath()\r\n                    ctx.fill()\r\n                }\r\n                ctx.stroke()\r\n\r\n\r\n                if (surface == ViewState.focusedSurface) {\r\n                    ctx.save()\r\n                    ctx.strokeStyle = \"orange\"\r\n                    ctx.lineWidth = 3 / scale\r\n                    ctx.beginPath()\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = (i / N - 0.5) * 2 * R\r\n                        let z = surface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        if (i == 0)\r\n                            ctx.moveTo(z0 + z, r)\r\n                        else\r\n                            ctx.lineTo(z0 + z, r)\r\n                    }\r\n                    ctx.stroke()\r\n                    ctx.restore()\r\n                }\r\n\r\n\r\n                z0 += surface.thickness.value\r\n            }\r\n\r\n\r\n            // Draw Rays\r\n            ctx.lineWidth = 1.5 / scale\r\n\r\n            for (let i = 0; i < result[0][0].length; i++) {\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                ctx.beginPath()\r\n                for (let j = 0; j < result.length; j++) {\r\n                    let y = result[j][1][i]\r\n                    let z = result[j][2][i]\r\n                    if (j == 0) ctx.moveTo(z, y)\r\n                    else ctx.lineTo(z, y)\r\n                }\r\n                ctx.stroke()\r\n            }\r\n\r\n\r\n\r\n\r\n        }, 50)\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        },\r\n        ViewState: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.lens_plot {\r\n    position: relative;\r\n    width: 500px;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport { toRaw } from \"vue\"\r\n\r\n\r\n/**\r\n * @param {OpticSystem} system \r\n * @param {tf.Tensor} raypos\r\n * @param {tf.Tensor} raydir \r\n*/\r\nfunction RayTrace(system, raypos, raydir) {\r\n    return tf.tidy(() => {\r\n\r\n        let result = []\r\n        result.push(raypos)\r\n\r\n        let n1 = 1\r\n        let z = tf.tensor(0)\r\n        for (let surface of system.surfaces) {\r\n            let n2 = surface.material.index\r\n\r\n\r\n            raypos = surface.shape.trace(raypos.sub(tf.tensor([[0], [0], [1]]).mul(z)), raydir)\r\n            let normal = surface.shape.normal(raypos)\r\n\r\n\r\n            raydir = raydir.div(raydir.mul(raydir).sum(0).sqrt()).mul(n1)\r\n            normal = normal.mul(raydir.mul(normal).sum(0).sign())\r\n            let cos = raydir.mul(normal).sum(0)\r\n            let tangent2 = tf.sub(n1 ** 2, cos.mul(cos))\r\n            let displace = tf.sub(n2 ** 2, tangent2).sqrt().sub(tf.sub(n1 ** 2, tangent2).sqrt())\r\n            raydir = raydir.add(normal.mul(displace))\r\n\r\n\r\n            raypos = raypos.add(tf.tensor([[0], [0], [1]]).mul(z))\r\n            result.push(raypos)\r\n            n1 = n2\r\n\r\n            z = z.add(toRaw(surface.thickness.value))\r\n        }\r\n\r\n\r\n        // result.push(raypos.add(raydir).arraySync())\r\n\r\n        return result\r\n    })\r\n}\r\n\r\n\r\nexport default RayTrace","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction PlotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 7\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n        for (let field of system.fields) {\r\n            let f = (i / N - 0.5) * 2\r\n            raypos.push(field.raypos(0, f, system))\r\n            raydir.push(field.raydir(0, f, system))\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    return RayTrace(system, raypos, raydir)\r\n}\r\n\r\nexport default PlotTrace","import { render } from \"./LensPlot.vue?vue&type=template&id=2b913eb6&scoped=true\"\nimport script from \"./LensPlot.vue?vue&type=script&lang=js\"\nexport * from \"./LensPlot.vue?vue&type=script&lang=js\"\n\nimport \"./LensPlot.vue?vue&type=style&index=0&id=2b913eb6&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2b913eb6\"]])\n\nexport default __exports__","import OpticSystem from \"./OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\ntf.setBackend('cpu')\r\nconst system = new OpticSystem()\r\n\r\nexport default {\r\n    system\r\n}","import OpticSurface from \"./OpticSurface\"\r\nimport OpticSystem from \"./OpticSystem\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport OpticField from \"./OpticField\"\r\nimport OpticShapeSpherical from \"./shapes/OpticShapeSpherical\"\r\nimport OpticMaterial from \"./material/OpticMaterial\"\r\n\r\nclass Serializer {\r\n    classes = {}\r\n    /**\r\n     * \r\n     * @param {Array} classes \r\n     */\r\n    constructor(classes) {\r\n        for (let classdef of classes) {\r\n            this.classes[classdef.name] = classdef\r\n        }\r\n    }\r\n    serialize(object) {\r\n        return JSON.stringify(this._serialize(object))\r\n    }\r\n\r\n    _serialize(object) {\r\n        if (object._SP) {\r\n            let obj = { _class: object.constructor.name }\r\n            for (let i of object._SP) {\r\n                obj[i] = this._serialize(object[i])\r\n            }\r\n            return obj\r\n        } else if (object instanceof Array) {\r\n            return object.map(x => this._serialize(x))\r\n        } else if (object instanceof Object) {\r\n            let obj = {}\r\n            for (let i in object) {\r\n                obj[i] = this._serialize(object[i])\r\n            }\r\n            return obj\r\n        } return object\r\n    }\r\n\r\n    deserialize(str, obj) {\r\n        return this._deserialize(JSON.parse(str), obj)\r\n    }\r\n\r\n    _deserialize(object) {\r\n        if (object._class) {\r\n            let classdef = this.classes[object._class]\r\n            if (classdef) {\r\n                let obj = new classdef()\r\n                for (let i of obj._SP) {\r\n                    obj[i] = this._deserialize(object[i])\r\n                }\r\n                return obj\r\n            } else {\r\n                console.error(\"no class define:\", object._class)\r\n            }\r\n        } else if (object instanceof Array) {\r\n            return object.map(x => this._deserialize(x))\r\n        } else if (object instanceof Object) {\r\n            let obj = {}\r\n            for (let i in object) {\r\n                obj[i] = this._deserialize(object[i])\r\n            }\r\n            return obj\r\n        } return object\r\n    }\r\n}\r\n\r\n\r\nconst serializer = new Serializer([\r\n    OpticSystem, OpticSurface,\r\n    OpticVar, OpticField,\r\n    OpticShapeSpherical,\r\n    OpticMaterial\r\n])\r\n\r\n\r\nexport default serializer\r\n","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Field Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"content\">\r\n                <label for=\"diameter\">D=</label>\r\n                <OpticVarInput id=\"diameter\" :step=\"0.01\"\r\n                    :variable=\"system.pupilDiameter\" />\r\n\r\n                <label for=\"Z\">Z=</label>\r\n                <OpticVarInput id=\"Z\" :step=\"0.01\"\r\n                    :variable=\"system.pupilOffset\" />\r\n            </div>\r\n            <div class=\"ui_sheet-row\"\r\n                v-for=\"field, i in system.fields\" :key=\"i\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button\r\n                            @click=\"system.fields.splice(i, 1)\">Del</button>\r\n                        <button\r\n                            @click=\"addField(i)\">Add</button>\r\n                    </div>\r\n                    <OpticFieldComponent :field=\"field\">\r\n                    </OpticFieldComponent>\r\n                </div>\r\n            </div>\r\n            <div class=\"ui_sheet-row\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button\r\n                            @click=\"addField(system.fields.length)\">Add</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"content\">\r\n                <p>D=Entrance Diameter, Z=Distance to the pupil</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport OpticFieldComponent from './OpticFieldComponent.vue'\r\nimport OpticVarInput from './OpticVarInput.vue'\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticFieldComponent,\r\n        OpticVarInput\r\n    },\r\n    methods: {\r\n        addField(i) {\r\n            this.system.fields.splice(i, 0, new OpticField())\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","<template>\r\n    <div>\r\n        <label for=\"angle\">angle=</label>\r\n        <OpticVarInput id=\"angle\" :step=\"0.02\"\r\n            :variable=\"field.angle\" />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticVarInput from './OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        field: OpticField\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import { render } from \"./OpticFieldComponent.vue?vue&type=template&id=641ebbd2\"\nimport script from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./FieldSheet.vue?vue&type=template&id=55212918\"\nimport script from \"./FieldSheet.vue?vue&type=script&lang=js\"\nexport * from \"./FieldSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"analyze_plot ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Spot Diagram</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"analyze_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport SpotTrace from '@/optic/analyze/SpotTrace'\r\nimport { toRaw } from 'vue'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport { stopForAxis } from '@tensorflow/tfjs-core/dist/ops/slice_util'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        update: asyncThrottle(10, async function () {\r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await SpotTrace(this.system).array()\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n\r\n            ctx.beginPath()\r\n            let ymax = result[1][0]\r\n            let ymin = result[1][0]\r\n\r\n\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                let y = result[1][i]\r\n                if (isNaN(y)) continue\r\n                ymax = Math.max(y, ymax)\r\n                ymin = Math.min(y, ymin)\r\n            }\r\n\r\n            let scale = canvas.height / (ymax - ymin + 2) * 0.8\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(0, -(ymax + ymin) / 2)\r\n            ctx.lineWidth = 1 / scale\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                ctx.beginPath()\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                let x = result[0][i]\r\n                let y = result[1][i]\r\n                ctx.rect(x - 1 / scale, y - 1 / scale, 2 / scale, 2 / scale)\r\n                ctx.stroke()\r\n            }\r\n        })\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.analyze_plot {\r\n    position: relative;\r\n    width: 200px;\r\n    height: 100%;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction SpotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 5\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n\r\n\r\n        let f = i / N\r\n\r\n        let N2 = f * 16 + 1\r\n        for (let j = 0; j < N2; j++) {\r\n\r\n            let f2 = j / N2\r\n\r\n            let fx = f * Math.cos(f2 * Math.PI * 2)\r\n            let fy = f * Math.sin(f2 * Math.PI * 2)\r\n\r\n            for (let field of system.fields) {\r\n                raypos.push(field.raypos(fx, fy, system))\r\n                raydir.push(field.raydir(fx, fy, system))\r\n            }\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    let result = RayTrace(system, raypos, raydir)\r\n    let spot = result[result.length - 1]\r\n\r\n    return spot\r\n}\r\n\r\nexport default SpotTrace","import { render } from \"./AnalyzePlot.vue?vue&type=template&id=4a6eace6&scoped=true\"\nimport script from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\nexport * from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\n\nimport \"./AnalyzePlot.vue?vue&type=style&index=0&id=4a6eace6&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4a6eace6\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"optimize_wizard ui_block\">\r\n        <div class=\"ui_block-header\">Optimizer</div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\"\r\n                    name=\"updateOnSystemChange\"\r\n                    id=\"updateOnSystemChange\"\r\n                    v-model=\"updateOnSystemChange\">\r\n                <label for=\"updateOnSystemChange\">Update\r\n                    merit on\r\n                    change</label>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <p>Current Merit: {{\r\n                        merit.toPrecision(6)\r\n                }}\r\n                </p>\r\n\r\n            </div>\r\n            <div class=\"row content\">\r\n                <button @click=\"updateMerit\">Calculate\r\n                    Current</button>\r\n\r\n                <button @click=\"stop\"\r\n                    v-if=\"this.iterate\">Stop!</button>\r\n                <button @click=\"optimize\"\r\n                    v-else>Optimize!</button>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <label for=\"maxIteration\">Max:</label>\r\n                <input type=\"number\" name=\"maxIteration\"\r\n                    id=\"maxIteration\"\r\n                    v-model=\"maxIteration\">\r\n                <p>Iterations: {{ iterations }}</p>\r\n            </div>\r\n\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\" name=\"updateView\"\r\n                    id=\"updateView\" v-model=\"updateView\">\r\n                <label for=\"updateView\">Update\r\n                    view</label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport Optimize from '@/optic/analyze/Optimize'\r\nimport Merit from '@/optic/analyze/Merit'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            merit: 0,\r\n            iterate: null,\r\n            apply: null,\r\n            iterations: 0,\r\n            maxIteration: 20,\r\n            timeout: null,\r\n            updateOnSystemChange: true,\r\n            updateView: false\r\n        }\r\n    },\r\n    methods: {\r\n        updateMerit: throttle(10, function () {\r\n            this.merit = Merit(this.system).arraySync()[0]\r\n        }),\r\n        async optimize() {\r\n            this.iterations = 0\r\n            let [iterate, apply] = await Optimize(this.system)\r\n            this.iterate = iterate\r\n            this.apply = apply\r\n            this.update()\r\n        },\r\n        update() {\r\n            if (this.timeout) clearTimeout(this.timeout)\r\n            if (this.iterations >= this.maxIteration) this.stop()\r\n            else if (this.iterate) {\r\n                let vm = this\r\n                this.iterate().then((merit) => {\r\n                    this.merit = merit\r\n                    if (this.updateView) this.apply()\r\n                    vm.timeout = setTimeout(() => {\r\n                        vm.iterations += 1\r\n                        vm.update()\r\n                    }, 0)\r\n                })\r\n            }\r\n        },\r\n        stop() {\r\n            if (this.apply) {\r\n                this.system.update += 1\r\n                this.apply()\r\n                this.apply = null\r\n            }\r\n            this.updateMerit()\r\n            this.iterate = null\r\n            clearTimeout(this.timeout)\r\n            this.timeout = null\r\n        }\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                if (this.updateOnSystemChange && !this.iterate) {\r\n                    this.updateMerit()\r\n                }\r\n            },\r\n            deep: true\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.optimize_wizard {\r\n    max-width: 300px;\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction Merit(system) {\r\n    return tf.tidy(() => {\r\n\r\n        let merit = tf.tensor([0])\r\n\r\n        for (let field of system.fields) {\r\n            merit = tf.tidy(() => {\r\n                const raypos1 = []\r\n                const raydir1 = []\r\n                const N = 3\r\n\r\n                // Go through every field and create rays\r\n                for (let i = 0; i <= N; i++) {\r\n                    const f = i / N\r\n                    const N2 = 3 * f + 1\r\n\r\n                    for (let j = 0; j <= N2; j++) {\r\n                        const f2 = j / N2 - 0.5\r\n                        const fx = f * Math.cos(f2 * Math.PI)\r\n                        const fy = f * Math.sin(f2 * Math.PI)\r\n                        raypos1.push(field.raypos(fx, fy, system))\r\n                        raydir1.push(field.raydir(fx, fy, system))\r\n                    }\r\n                }\r\n\r\n                const raypos = tf.tensor(raypos1).transpose()\r\n                const raydir = tf.tensor(raydir1).transpose()\r\n\r\n                const result = RayTrace(system, raypos, raydir)\r\n                const spot = result[result.length - 1]\r\n\r\n                const delta = spot.sub(spot.gather(0, 1).expandDims(1))\r\n\r\n                const error = delta.mul(delta)\r\n                const mask = error.isNaN().logicalNot()\r\n                const maxerror = error.where(mask, 0).max().add(1e5)\r\n                return merit.add(error.where(mask, maxerror).sum())\r\n            })\r\n        }\r\n\r\n        return merit\r\n    })\r\n}\r\n\r\nexport default Merit","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport Merit from \"./Merit\"\r\nimport { toRaw } from \"vue\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nasync function Optimize(system) {\r\n\r\n\r\n    let variables = []\r\n    variables.push(system.pupilOffset)\r\n    for (let surface of system.surfaces) {\r\n        variables.push(surface.shape.curvature)\r\n        variables.push(surface.thickness)\r\n    }\r\n\r\n    variables = variables.filter(x => x.optimize)\r\n\r\n    let rawVariables = variables.map(toRaw)\r\n    let x0 = rawVariables.map(x => x.value)\r\n\r\n\r\n    async function evaluate(x) {\r\n        rawVariables.map((variable, i) => {\r\n            variable.value = x[i]\r\n        })\r\n        return (await Merit(system).array())[0]\r\n    }\r\n\r\n    async function evaluateAll(seeds, scores) {\r\n        for (let i = 0; i < seeds.length; i++) {\r\n            scores[i] = await evaluate(seeds[i])\r\n        }\r\n    }\r\n\r\n    const seeds = [x0]\r\n\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 0.01))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n\r\n    const N = seeds.length\r\n\r\n\r\n    const scores = []\r\n    const newScores = []\r\n    const newSeeds = []\r\n    await evaluateAll(seeds, scores)\r\n\r\n    let bestScore = scores[0]\r\n    let bestSeed = seeds[0]\r\n\r\n\r\n    async function iterate(F = 0.9) {\r\n        for (let i = 0; i < N; i++) {\r\n            const a = Math.floor(Math.random() * N)\r\n            const b = Math.floor(Math.random() * N)\r\n            const c = Math.floor(Math.random() * N)\r\n            const z = Math.floor(Math.random() * N)\r\n\r\n            const A = seeds[a]\r\n            const B = seeds[b]\r\n            const C = seeds[c]\r\n\r\n            newSeeds[i] = seeds[i].map((x, j) => {\r\n                if (j !== z && Math.random() < 0.3) return x\r\n                return A[j] + (B[j] - C[j]) * F\r\n            })\r\n        }\r\n\r\n        await evaluateAll(newSeeds, newScores)\r\n\r\n        for (let i = 0; i < N; i++) {\r\n            if (!isNaN(newScores[i]) && newScores[i] < scores[i]) {\r\n                scores[i] = newScores[i]\r\n                seeds[i] = newSeeds[i]\r\n\r\n                if (isNaN(bestScore) || scores[i] < bestScore) {\r\n                    bestScore = scores[i]\r\n                    bestSeed = seeds[i]\r\n                }\r\n            }\r\n        }\r\n\r\n        return bestScore\r\n    }\r\n\r\n    function apply() {\r\n        rawVariables.map((x, i) => {\r\n            x.value = null\r\n        })\r\n        variables.map((x, i) => {\r\n            x.value = bestSeed[i]\r\n        })\r\n    }\r\n\r\n    return [iterate.bind(this), apply.bind(this)]\r\n}\r\n\r\nexport default Optimize","import { render } from \"./OptimizeWizard.vue?vue&type=template&id=2fd3bb79&scoped=true\"\nimport script from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\nexport * from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\n\nimport \"./OptimizeWizard.vue?vue&type=style&index=0&id=2fd3bb79&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2fd3bb79\"]])\n\nexport default __exports__","function debounce(time, fun) {\r\n\r\n    let timeout = null\r\n    let thisarg = null\r\n    let args = []\r\n\r\n    function delayed() {\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout) {\r\n            clearTimeout(timeout)\r\n        }\r\n\r\n        timeout = setTimeout(function () {\r\n            fun.apply(thisarg, args)\r\n            timeout = null\r\n        }, time)\r\n    }\r\n    return delayed\r\n}\r\n\r\n\r\nexport { debounce }","import { render } from \"./App.vue?vue&type=template&id=604d9ce6&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=604d9ce6&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-604d9ce6\"]])\n\nexport default __exports__","\r\nimport { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './style/index.scss'\r\ncreateApp(App).mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkoptictool\"] = self[\"webpackChunkoptictool\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(8567); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","onClick","$options","_hoisted_5","stateHead","state","length","this","_hoisted_6","_createVNode","_component_LensPlot","system","$data","_component_AnalyzePlot","_hoisted_7","_component_LensSheet","_component_FieldSheet","_component_OptimizeWizard","_hoisted_8","_Fragment","$props","surfaces","surface","i","key","onMousedown","splice","_component_OpticSurfaceComponent","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","OpticMaterial","constructor","index","OpticVar","value","ensurevalue","v","tf","arraySync","OpticShapeSpherical","curvature","trace","raypos","raydir","c","toRaw","l","gather","div","mul","A","sum","B","sub","C","sqrt","dispose","add","normal","p","n","r","r2","Math","OpticSurface","thickness","material","shape","OpticField","angle","fx","fy","R","pupilDiameter","PZ","pupilOffset","a","z","x","y","sin","PI","cos","OpticSystem","for","_component_OpticVarInput","id","type","step","variable","min","max","toPrecision","optimize","ref","name","asyncThrottle","time","fun","timeout","dirty","thisarg","args","async","delayed","arguments","apply","setTimeout","throttle","props","Number","data","editmode","tweakmode","tweaked","tempValue","methods","mousedown","event","preventDefault","mouseup","$refs","input","focus","mousemove","movementX","updatevalue","reset","menuclick","mounted","addEventListener","beforeUnmount","removeEventListener","__exports__","components","OpticVarInput","ViewState","focusedSurface","colorlist","OpticSurfaceComponent","addSurface","hover","RayTrace","result","push","n1","n2","sign","tangent2","displace","PlotTrace","N","field","fields","f","transpose","canvas","ctx","resize","rect","container","getBoundingClientRect","width","height","update","Promise","all","map","array","resetTransform","clearRect","translate","ttl","Rlist","Rmax","j","isNaN","abs","scale","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","z0","fillStyle","isSolid","nextsurface","closePath","fill","save","restore","watch","handler","deep","getContext","unmounted","Serializer","classes","classdef","serialize","object","JSON","stringify","_serialize","_SP","obj","_class","Array","Object","deserialize","str","_deserialize","parse","console","error","serializer","_component_OpticFieldComponent","_hoisted_13","_hoisted_14","OpticFieldComponent","addField","SpotTrace","N2","f2","spot","ymax","ymin","iterate","Merit","merit","raypos1","raydir1","delta","expandDims","mask","logicalNot","maxerror","where","Optimize","variables","filter","rawVariables","x0","evaluate","evaluateAll","seeds","scores","random","newScores","newSeeds","bestScore","bestSeed","F","floor","b","bind","iterations","maxIteration","updateOnSystemChange","updateView","updateMerit","clearTimeout","stop","vm","then","debounce","optic","no_record","LensSheet","LensPlot","FieldSheet","AnalyzePlot","OptimizeWizard","undo","load","redo","open","document","createElement","onchange","reader","FileReader","readAsText","files","onload","e","target","log","click","filename","contents","blob","Blob","File","createEvent","download","href","window","URL","createObjectURL","dataset","downloadurl","join","render","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","loaded","__webpack_modules__","call","m","amdD","Error","amdO","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","keys","every","getter","__esModule","d","definition","o","defineProperty","enumerable","get","g","globalThis","Function","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","__webpack_exports__"],"sourceRoot":""}