(function(){var e={7759:function(e,t,n){"use strict";var s=n(9242),r=n(3396);const u={class:"container"};function i(e,t,n,s,i,a){const o=(0,r.up)("LensPlot"),c=(0,r.up)("LensSheet");return(0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("div",null,[(0,r.Wm)(o,{system:i.system},null,8,["system"])]),(0,r._)("div",null,[(0,r.Wm)(c,{system:i.system},null,8,["system"])])])}const a=e=>((0,r.dD)("data-v-92b10238"),e=e(),(0,r.Cn)(),e),o=a((()=>(0,r._)("p",null,"Lens Data",-1))),c={class:"lens-sheet_row-end"},l=["onClick"],d=["onClick"],f=a((()=>(0,r._)("p",null,"t=thickness, c=curvature (1/R), n=index of refraction",-1)));function h(e,t,n,s,u,i){return(0,r.wg)(),(0,r.iD)("div",null,[o,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.system.surfaces,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{class:"lens-sheet_row",key:t},[((0,r.wg)(),(0,r.j4)((0,r.LL)(e.component),{surface:e},null,8,["surface"])),(0,r._)("div",c,[(0,r._)("button",{onClick:e=>i.addSurface(t),class:"btn_add"},"Add",8,l),(0,r._)("button",{onClick:e=>n.system.surfaces.splice(t,1)},"Del",8,d)])])))),128)),(0,r._)("button",{onClick:t[0]||(t[0]=e=>i.addSurface(n.system.surfaces.length))},"Add"),f])}var m=n(7327);class p{constructor(e){(0,m.Z)(this,"index",1.5),this.index=e}}var v=p,y=n(5789);class b{constructor(e,t,n){(0,m.Z)(this,"thickness",0),(0,m.Z)(this,"curvature",0),(0,m.Z)(this,"material",new v(1.5)),(0,m.Z)(this,"component","OpticSurfaceComponent"),this.thickness=e||this.thickness,this.curvature=t||this.curvature,this.material=n||this.material}trace(e,t){const n=this.curvature;if(0==n){const n=e.gather(2).div(t.gather(2)).mul(-1);return e.add(t.mul(n))}{const s=t.mul(t).sum(0).mul(n),r=e.mul(t).sum(0).mul(n).sub(t.gather(2)).mul(2),u=e.mul(e).sum(0).mul(n).sub(e.gather(2).mul(2)),i=r.mul(-1).sub(r.mul(r).sub(s.mul(u).mul(4)).sqrt()).div(s).div(2);return e.add(t.mul(i))}}normal(e){const t=this.curvature;if(0==t)return e.mul(0).add(y.XeE([[0],[0],[-1]]));{let n=e.sub(y.XeE([[0],[0],[1/t]]));return n.div(n.mul(n).sum(0).sqrt())}}shape(e){const t=e**2;return t*this.curvature/(1+Math.sqrt(1-t*this.curvature**2))}}var w=b;class g{constructor(){(0,m.Z)(this,"surfaces",[new w(6.1,.04,new v(1.5108)),new w(2.8,-.01,new v(1)),new w(1.3,-.01,new v(1.6042)),new w(5.9,.04,new v(1)),new w(7.4,.02,new v(1.5108)),new w(35,-.04,new v(1)),new w(0,0,new v(1))])}}var _=g;const k=(0,r._)("label",{for:"thickness"},"t=",-1),S=(0,r._)("span",null,", ",-1),x=(0,r._)("label",{for:"curvature"},"c=",-1),O=(0,r._)("span",null,", ",-1),C=(0,r._)("label",{for:"material"},"n=",-1);function D(e,t,n,u,i,a){return(0,r.wg)(),(0,r.iD)("div",null,[k,(0,r.wy)((0,r._)("input",{id:"thickness",type:"number",step:"0.05","onUpdate:modelValue":t[0]||(t[0]=e=>n.surface.thickness=e)},null,512),[[s.nr,n.surface.thickness,void 0,{number:!0}]]),S,x,(0,r.wy)((0,r._)("input",{id:"thickness",type:"number",step:"0.002","onUpdate:modelValue":t[1]||(t[1]=e=>n.surface.curvature=e)},null,512),[[s.nr,n.surface.curvature,void 0,{number:!0}]]),O,C,(0,r.wy)((0,r._)("input",{id:"material",type:"number",step:"0.01",min:"1",max:"99","onUpdate:modelValue":t[2]||(t[2]=e=>n.surface.material.index=e)},null,512),[[s.nr,n.surface.material.index,void 0,{number:!0}]])])}var E={props:{surface:w},data(){return{thickness:0}}},Z=n(89);const j=(0,Z.Z)(E,[["render",D]]);var L=j,T={props:{system:_},components:{OpticSurfaceComponent:L},methods:{addSurface(e){this.system.surfaces.splice(e,0,new w)}}};const P=(0,Z.Z)(T,[["render",h],["__scopeId","data-v-92b10238"]]);var q=P;const z={class:"lens-plot_main"},U={ref:"container",class:"lens-plot_container"},X={ref:"canvas"};function R(e,t,n,s,u,i){return(0,r.wg)(),(0,r.iD)("div",z,[(0,r._)("div",U,[(0,r._)("canvas",X,null,512)],512)])}n(7658);function M(e){y.SRH().startScope();let t=[],n=[],s=11;const r=20;for(let o=0;o<s;o++){let e=(o/s-.5)*r;t.push([0,1*e,-1]),n.push([0,0,1]),t.push([0,1*e+10,-1]),n.push([0,-.5,1])}t=y.XeE(t).transpose(),n=y.XeE(n).transpose();let u=[];u.push(t.arraySync());e.surfaces[0];let i=1,a=0;for(let o of e.surfaces){let e=o.material.index;t=o.trace(t.sub(y.XeE([[0],[0],[a]])),n);let s=o.normal(t);n=n.div(n.mul(n).sum(0).sqrt()).mul(i),s=s.mul(n.mul(s).sum(0).sign());let r=y.luU(1,n.mul(s).sum(0)),c=y.luU(e**2,r).sqrt().sub(y.luU(i**2,r).sqrt());n=n.add(s.mul(c)),t=t.add(y.XeE([[0],[0],[a]])),u.push(t.arraySync()),i=e,a+=o.thickness}return y.SRH().endScope(),u}var W=M,$={props:{system:_},data(){return{canvas:null,ctx:null}},methods:{resize(){const e=this.$refs.container.getBoundingClientRect();this.$refs.canvas.width=e.width,this.$refs.canvas.height=e.height,this.update()},update(){const e=this.canvas,t=this.ctx;t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.translate(e.width/2,e.height/2);let n=0;for(let a of this.system.surfaces)n+=a.thickness;let s=e.width/n*.8;t.scale(s,s),t.lineWidth=1/s,t.translate(-n/2,0);const r=W(this.system);t.strokeStyle="blue";for(let a=0;a<r[0][0].length;a++){t.beginPath();for(let e=0;e<r.length;e++){let n=r[e][1][a],s=r[e][2][a];0==e?t.moveTo(s,n):t.lineTo(s,n)}t.stroke()}t.lineWidth=2/s,t.strokeStyle="black";const u=30;let i=0;for(let a of this.system.surfaces){let e=15;t.beginPath();for(let n=0;n<=u;n++){let s=2*(n/u-.5)*e,r=a.shape(s);0==n?t.moveTo(i+r,s):t.lineTo(i+r,s)}t.stroke(),i+=a.thickness}}},watch:{system:{handler(){this.update()},deep:!0}},mounted(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),addEventListener("resize",this.resize),this.resize()},unmounted(){removeEventListener("resize",this.resize)}};const A=(0,Z.Z)($,[["render",R],["__scopeId","data-v-be8aafec"]]);var H=A;const V=new _;var I={system:V},B={name:"App",data(){return{system:I.system}},components:{LensSheet:q,LensPlot:H},watch:{system:{handler(){},deep:!0}}};const F=(0,Z.Z)(B,[["render",i]]);var K=F;(0,s.ri)(K).mount("#app")},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var u=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(u.exports,u,u.exports,n),u.loaded=!0,u.exports}n.m=e,function(){n.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){n.amdO={}}(),function(){var e=[];n.O=function(t,s,r,u){if(!s){var i=1/0;for(l=0;l<e.length;l++){s=e[l][0],r=e[l][1],u=e[l][2];for(var a=!0,o=0;o<s.length;o++)(!1&u||i>=u)&&Object.keys(n.O).every((function(e){return n.O[e](s[o])}))?s.splice(o--,1):(a=!1,u<i&&(i=u));if(a){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}u=u||0;for(var l=e.length;l>0&&e[l-1][2]>u;l--)e[l]=e[l-1];e[l]=[s,r,u]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,u,i=s[0],a=s[1],o=s[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(o)var l=o(n)}for(t&&t(s);c<i.length;c++)u=i[c],n.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return n.O(l)},s=self["webpackChunkoptictool"]=self["webpackChunkoptictool"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(7759)}));s=n.O(s)})();
//# sourceMappingURL=app.89c8040b.js.map