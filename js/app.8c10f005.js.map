{"version":3,"file":"js/app.8c10f005.js","mappings":"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","sources":["webpack://optictool/./src/App.vue","webpack://optictool/./src/components/LensSheet.vue","webpack://optictool/./src/scripts/compress.js","webpack://optictool/./src/scripts/Serializer.js","webpack://optictool/./src/optic/material/OpticMaterial.js","webpack://optictool/./src/optic/OpticVar.js","webpack://optictool/./src/optic/shapes/OpticShapeSpherical.js","webpack://optictool/./src/optic/OpticSurface.js","webpack://optictool/./src/optic/OpticField.js","webpack://optictool/./src/optic/OpticSystem.js","webpack://optictool/./src/components/common/SheetUI.vue","webpack://optictool/./src/components/common/SheetUI.vue?585d","webpack://optictool/./src/components/OpticSurfaceComponent.vue","webpack://optictool/./src/components/common/OpticVarInput.vue","webpack://optictool/./src/scripts/throttle.js","webpack://optictool/./src/components/common/OpticVarInput.vue?027c","webpack://optictool/./src/components/OpticSurfaceComponent.vue?b88a","webpack://optictool/./src/components/ViewControl.js","webpack://optictool/./src/components/LensSheet.vue?c9b6","webpack://optictool/./src/components/LensPlot.vue","webpack://optictool/./src/optic/analyze/RayTrace.js","webpack://optictool/./src/optic/analyze/PlotTrace.js","webpack://optictool/./src/components/LensPlot.vue?38c6","webpack://optictool/./src/optic/index.js","webpack://optictool/./src/components/FieldSheet.vue","webpack://optictool/./src/components/OpticFieldComponent.vue","webpack://optictool/./src/components/OpticFieldComponent.vue?f754","webpack://optictool/./src/components/FieldSheet.vue?7e0e","webpack://optictool/./src/components/AnalyzePlot.vue","webpack://optictool/./src/optic/analyze/SpotTrace.js","webpack://optictool/./src/components/AnalyzePlot.vue?afb0","webpack://optictool/./src/components/OptimizeWizard.vue","webpack://optictool/./src/optic/analyze/Merit.js","webpack://optictool/./src/optic/analyze/Optimize.js","webpack://optictool/./src/components/OptimizeWizard.vue?f450","webpack://optictool/./src/scripts/debounce.js","webpack://optictool/./src/App.vue?7ccd","webpack://optictool/./src/main.js","webpack://optictool/webpack/bootstrap","webpack://optictool/webpack/runtime/amd define","webpack://optictool/webpack/runtime/amd options","webpack://optictool/webpack/runtime/chunk loaded","webpack://optictool/webpack/runtime/compat get default export","webpack://optictool/webpack/runtime/define property getters","webpack://optictool/webpack/runtime/global","webpack://optictool/webpack/runtime/hasOwnProperty shorthand","webpack://optictool/webpack/runtime/make namespace object","webpack://optictool/webpack/runtime/node module decorator","webpack://optictool/webpack/runtime/jsonp chunk loading","webpack://optictool/webpack/startup"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"row\">\r\n      <h2>Optic Tool </h2>\r\n      <div></div>\r\n      <button @click=\"open\">Open</button>\r\n      <button @click=\"save\">Save</button>\r\n      <div></div>\r\n      <button @click=\"undo\">Undo\r\n        {{ this.stateHead - 1 }}</button>\r\n      <button @click=\"redo\">Redo\r\n        {{ this.state.length - this.stateHead }}</button>\r\n    </div>\r\n    <div class=\"row top_row\">\r\n      <LensPlot :system=\"system\"></LensPlot>\r\n      <AnalyzePlot :system=\"system\"></AnalyzePlot>\r\n    </div>\r\n    <div class=\"row\">\r\n      <LensSheet :system=\"system\"></LensSheet>\r\n      <FieldSheet :system=\"system\"></FieldSheet>\r\n      <OptimizeWizard :system=\"system\"></OptimizeWizard>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"content\">\r\n        <h3>About this project</h3>\r\n        <p>Developer: <a\r\n            href=\"https://chiuhans111.github.io\">Hans\r\n            Chiu</a></p>\r\n        <p>Project repo: <a\r\n            href=\"https://github.com/chiuhans111/OpticTool\">https://github.com/chiuhans111/OpticTool</a>\r\n        </p>\r\n      </div>\r\n      <div class=\"content\">\r\n        <h3>How to use?</h3>\r\n        <p>Drag the input box to modify value.</p>\r\n        <p>Click the input box to edit and set optimization\r\n          variable.</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LensSheet from './components/LensSheet.vue'\r\nimport LensPlot from './components/LensPlot.vue'\r\nimport optic from './optic'\r\nimport serializer from './scripts/Serializer'\r\nimport FieldSheet from './components/FieldSheet.vue'\r\nimport AnalyzePlot from './components/AnalyzePlot.vue'\r\nimport OptimizeWizard from './components/OptimizeWizard.vue'\r\nimport { throttle } from './scripts/throttle'\r\nimport { debounce } from './scripts/debounce'\r\nimport { toRaw } from 'vue'\r\nexport default {\r\n  name: 'App',\r\n  data() {\r\n    return {\r\n      system: optic.system,\r\n      state: [],\r\n      no_record: false,\r\n      stateHead: 0\r\n    }\r\n  },\r\n  components: {\r\n    LensSheet,\r\n    LensPlot,\r\n    FieldSheet,\r\n    AnalyzePlot,\r\n    OptimizeWizard\r\n  },\r\n  mounted() {\r\n    this.push()\r\n  },\r\n  methods: {\r\n    undo() {\r\n      this.no_record = true\r\n      if (this.stateHead > 1)\r\n        this.stateHead--\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    redo() {\r\n      this.no_record = true\r\n      if (this.stateHead < this.state.length)\r\n        this.stateHead++\r\n      if (this.state.length > 0) {\r\n        this.load(this.state[this.stateHead - 1])\r\n      }\r\n    },\r\n    load(str) {\r\n      this.system = serializer.deserialize(str)\r\n    },\r\n    push: debounce(200, throttle(500, function () {\r\n      this.state.splice(this.stateHead)\r\n      let str = serializer.serialize(toRaw(this.system))\r\n      if (this.state.length == 0 || str !== this.state[this.state.length - 1]) {\r\n        this.state.push(str)\r\n        this.stateHead += 1\r\n      }\r\n    })),\r\n\r\n    open() {\r\n      let a = document.createElement('input')\r\n      a.type = 'file'\r\n      let vm = this\r\n      a.onchange = function () {\r\n        const reader = new FileReader()\r\n        reader.readAsText(a.files[0], \"UTF-8\")\r\n        reader.onload = function (e) {\r\n          vm.load(e.target.result)\r\n        }\r\n      }\r\n      a.click()\r\n\r\n\r\n    },\r\n    save() {\r\n      let filename = \"lens.json\"\r\n      var contents = serializer.serialize(toRaw(this.system))\r\n      var blob = new Blob([contents], { type: 'text/plain' })\r\n      var file = new File([blob], filename, { type: \"text/plain\" })\r\n      let a = document.createElement('a')\r\n      let e = document.createEvent('MouseEvents')\r\n      a.download = filename\r\n      a.href = window.URL.createObjectURL(blob)\r\n      a.dataset.downloadurl = ['text/obj', a.download, a.href].join(':')\r\n      a.click()\r\n    }\r\n  },\r\n  watch: {\r\n    system: {\r\n      handler() {\r\n        if (!this.no_record)\r\n          this.push()\r\n        this.no_record = false\r\n      },\r\n      deep: true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.top_row>div {\r\n  height: 450px;\r\n}\r\n</style>\r\n","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Lens Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n\r\n            <SheetUI :list=\"system.surfaces\"\r\n                :builder=\"buildSurface\">\r\n                <template #item=\"[surface, i]\">\r\n                    <OpticSurfaceComponent\r\n                        :surface=\"surface\" :key=\"i\">\r\n                    </OpticSurfaceComponent>\r\n                </template>\r\n            </SheetUI>\r\n\r\n            <div class=\"content\">\r\n                <p>t=thickness, c=curvature (1/R), n=index\r\n                    of\r\n                    refraction</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport SheetUI from './common/SheetUI.vue'\r\nimport OpticSurfaceComponent from './OpticSurfaceComponent.vue'\r\nimport ViewState from './ViewControl'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticSurfaceComponent,\r\n        SheetUI\r\n    },\r\n    methods: {\r\n        buildSurface(i) {\r\n            return new OpticSurface()\r\n        },\r\n        hover(surface) {\r\n            ViewState.focusedSurface = surface\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","/**\r\n * @param {string} str \r\n * @returns \r\n */\r\nfunction compress(str) {\r\n    str = str.replaceAll(/\"([^\",{}]+)\":/g, \"$1:\")\r\n    str = str.replaceAll(/{_:\"([^\",{}]+)\",/g, \"{$1,\")\r\n    str = str.replaceAll(/true/g, \"_1\")\r\n    str = str.replaceAll(/false/g, \"_0\")\r\n    return str\r\n}\r\n\r\n/**\r\n * @param {string} str \r\n * @returns \r\n */\r\nfunction decompress(str) {\r\n    str = str.replaceAll(/_1/g, \"true\")\r\n    str = str.replaceAll(/_0/g, \"false\")\r\n    str = str.replaceAll(/{([^\",{}]+),/g, '{_:\"$1\",')\r\n    str = str.replaceAll(/([^,\"{}]+):/g, '\"$1\":')\r\n    return str\r\n}\r\n\r\nexport { compress, decompress }","import { compress, decompress } from \"./compress\"\r\n\r\nclass Serializer {\r\n    classdefs = {}\r\n    classnames = {}\r\n\r\n    serializable(classname, param2v) {\r\n        const serializer = this\r\n        return function decorator(Class) {\r\n            if (classname in serializer.classdefs) console.error(\"duplicated classname\", classname)\r\n            if (Class.name in serializer.classnames) console.error(\"duplicated class\", Class.name)\r\n            const v2param = {}\r\n            for (let i in param2v) v2param[param2v[i]] = i\r\n            serializer.classdefs[classname] = {\r\n                Class, param2v, v2param\r\n            }\r\n            serializer.classnames[Class.name] = classname\r\n            return Class\r\n        }\r\n    }\r\n\r\n    serialize(object) {\r\n        return compress(JSON.stringify(this._serialize(object)))\r\n    }\r\n\r\n    _serialize(object) {\r\n        if (object instanceof Array) {\r\n            return object.map(x => this._serialize(x))\r\n        } else if (object instanceof Object) {\r\n            const obj = {}\r\n            if (object.constructor.name in this.classnames) {\r\n                obj._ = this.classnames[object.constructor.name]\r\n                const p2v = this.classdefs[obj._].param2v\r\n                for (let i in p2v) obj[p2v[i]] = this._serialize(object[i])\r\n            } else {\r\n                for (let i in object) obj[i] = this._serialize(object[i])\r\n            }\r\n            return obj\r\n        }\r\n        return object\r\n    }\r\n\r\n    deserialize(str, obj) {\r\n        return this._deserialize(JSON.parse(decompress(str)), obj)\r\n    }\r\n\r\n    _deserialize(object) {\r\n        if (object instanceof Array) {\r\n            return object.map(x => this._deserialize(x))\r\n        } else if (object instanceof Object) {\r\n            if (object._ && object._ in this.classdefs) {\r\n                const classdef = this.classdefs[object._]\r\n                const obj = new classdef.Class()\r\n                const v2p = classdef.v2param\r\n                for (let i in v2p) obj[v2p[i]] = this._deserialize(object[i])\r\n                return obj\r\n            } else {\r\n                const obj = {}\r\n                for (let i in object) obj[i] = this._deserialize(object[i])\r\n                return obj\r\n            }\r\n        } return object\r\n    }\r\n}\r\n\r\nconst serializer = new Serializer()\r\n\r\nexport default serializer\r\n","import serializer from \"../../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"n\", {\r\n    index: \"n\",\r\n})\r\nclass OpticMaterial {\r\n    index = 1.5\r\n    constructor(index) {\r\n        this.index = index\r\n    }\r\n}\r\n\r\nexport default OpticMaterial","import serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"v\", {\r\n    value: \"v\",\r\n    optimize: \"o\"\r\n})\r\nclass OpticVar {\r\n    value = 0\r\n    optimize = false\r\n    constructor(value) {\r\n        this.value = value || 0\r\n    }\r\n}\r\n\r\nexport default OpticVar","import * as tf from \"@tensorflow/tfjs\"\r\nimport { toRaw } from \"vue\"\r\nimport OpticVar from \"../OpticVar\"\r\nimport serializer from \"../../scripts/Serializer\"\r\n\r\nfunction ensurevalue(v) {\r\n    if (v instanceof tf.Tensor) {\r\n        return v.arraySync()[0]\r\n    }\r\n    else return v\r\n}\r\n\r\n@serializer.serializable(\r\n    \"o\", {\r\n    curvature: \"c\",\r\n})\r\nclass OpticShapeSpherical {\r\n    curvature = new OpticVar(0)\r\n\r\n    constructor(curvature) {\r\n        this.curvature.value = curvature\r\n    }\r\n\r\n    /** Find intersection position\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @param {tf.Tensor} raydir direction of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} intersection position\r\n    */\r\n    trace(raypos, raydir) {\r\n        const c = toRaw(this.curvature.value)\r\n        return tf.tidy(() => {\r\n            let l = raypos.gather(2).div(raydir.gather(2)).mul(-1)\r\n\r\n            if (ensurevalue(c) != 0) {\r\n\r\n                const A = raydir.mul(raydir).sum(0).mul(c)\r\n                const B = raypos.mul(raydir).sum(0).mul(c).sub(raydir.gather(2)).mul(2)\r\n                const C = raypos.mul(raypos).sum(0).mul(c).sub(raypos.gather(2).mul(2))\r\n                l = B.mul(-1).sub(B.mul(B).sub(A.mul(C).mul(4)).sqrt()).div(A).div(2)\r\n                A.dispose()\r\n                B.dispose()\r\n                C.dispose()\r\n            }\r\n\r\n            return raypos.add(raydir.mul(l))\r\n        })\r\n    }\r\n\r\n    /** Find the normal vector\r\n    * @param {tf.Tensor} raypos position of the ray, shape = [3(x,y,z), N]\r\n    * @returns {tf.Tensor} normal vector at given position\r\n    */\r\n    normal(raypos) {\r\n        const c = toRaw(this.curvature.value)\r\n\r\n        return tf.tidy(() => {\r\n            let p = raypos.mul(0).add(tf.tensor([[0], [0], [-1]]))\r\n            if (ensurevalue(c) != 0) {\r\n                let n = raypos.sub(tf.tensor([[0], [0], [1]]).div(c))\r\n                p = n.div(n.mul(n).sum(0).sqrt())\r\n            }\r\n\r\n            return p\r\n        })\r\n    }\r\n\r\n\r\n    surface(r) {\r\n        const r2 = r ** 2\r\n        return r2 * this.curvature.value / (1 + Math.sqrt(1 - r2 * this.curvature.value ** 2))\r\n    }\r\n}\r\n\r\nexport default OpticShapeSpherical","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport OpticShapeSpherical from \"./shapes/OpticShapeSpherical\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"s\", {\r\n    thickness: \"t\",\r\n    shape: \"s\",\r\n    material: \"n\",\r\n})\r\nclass OpticSurface {\r\n    thickness = new OpticVar(0)\r\n    shape = new OpticShapeSpherical(0)\r\n    material = new OpticMaterial(1.5)\r\n\r\n    constructor(thickness, curvature, material) {\r\n        this.thickness.value = thickness || this.thickness.value\r\n        this.shape.curvature.value = curvature || this.shape.curvature.value\r\n        this.material = material || this.material\r\n    }\r\n}\r\n\r\n\r\nexport default OpticSurface","import OpticSystem from \"./OpticSystem\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"f\", {\r\n    angle: \"a\",\r\n})\r\nclass OpticField {\r\n    angle = new OpticVar(0)\r\n\r\n    constructor(angle) {\r\n        this.angle.value = angle || this.angle.value\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Number} f \r\n     * @param {OpticSystem} system \r\n     * @returns \r\n     */\r\n    raypos(fx, fy, system) {\r\n        const R = system.pupilDiameter.value / 2\r\n        const PZ = system.pupilOffset.value\r\n        const a = this.angle.value\r\n\r\n        const z = -1\r\n        const x = fx * R\r\n        const y = fy * R + (PZ - z) * Math.sin(a / 180 * Math.PI)\r\n        return [x, y, z]\r\n    }\r\n\r\n    raydir(fx, fy) {\r\n        return [0, -Math.sin(this.angle.value / 180 * Math.PI), Math.cos(this.angle.value / 180 * Math.PI)]\r\n    }\r\n}\r\n\r\nexport default OpticField","import OpticMaterial from \"./material/OpticMaterial\"\r\nimport OpticField from \"./OpticField\"\r\nimport OpticSurface from \"./OpticSurface\"\r\nimport OpticVar from \"./OpticVar\"\r\nimport serializer from \"../scripts/Serializer\"\r\n\r\n@serializer.serializable(\r\n    \"$\", {\r\n    surfaces: \"s\",\r\n    fields: \"f\",\r\n    pupilDiameter: \"D\",\r\n    pupilOffset: \"Z\"\r\n})\r\nclass OpticSystem {\r\n    surfaces = [\r\n        new OpticSurface(3, 0.066667, new OpticMaterial(1.515)),\r\n        new OpticSurface(4, -0.01316, new OpticMaterial(1)),\r\n        new OpticSurface(1.5, -0.05882, new OpticMaterial(1.6438)),\r\n        new OpticSurface(2.5, 0.0625, new OpticMaterial(1)),\r\n        new OpticSurface(3, 0.022727, new OpticMaterial(1.515)),\r\n        new OpticSurface(40, -0.07143, new OpticMaterial(1)),\r\n        new OpticSurface(0, 0, new OpticMaterial(1))\r\n    ]\r\n\r\n    fields = [\r\n        new OpticField(0),\r\n        new OpticField(10),\r\n        new OpticField(20),\r\n    ]\r\n\r\n    pupilDiameter = new OpticVar(10)\r\n    pupilOffset = new OpticVar(10)\r\n\r\n    update = 0\r\n}\r\n\r\n\r\nexport default OpticSystem","<template>\r\n    <div class=\"ui_sheet\">\r\n        <transition-group name=\"list\" tag=\"div\"\r\n            class=\"ui_sheet-group\">\r\n            <div class=\"ui_sheet-row list-item\"\r\n                v-for=\"item, i in list\" :key=\"getid(item)\">\r\n                <div class=\"row\">\r\n                    <div class=\"ui_sheet-row-ui\">\r\n                        <button class=\"ui_sheet-btn\"\r\n                            @click=\"delItem(i)\">Del</button>\r\n                        <button class=\"ui_sheet-btn\"\r\n                            @click=\"addItem(i)\">Add</button>\r\n                    </div>\r\n                    <slot name=\"item\" v-bind=\"[item, i]\">\r\n\r\n                    </slot>\r\n                </div>\r\n            </div>\r\n        </transition-group>\r\n\r\n        <div class=\"ui_sheet-row\">\r\n            <div class=\"row\">\r\n                <button\r\n                    @click=\"addItem(list.length)\">Add</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { toRaw } from 'vue'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        list: Array,\r\n        builder: Function\r\n    },\r\n    methods: {\r\n        addItem(i) {\r\n            this.list.splice(i, 0, this.builder(i))\r\n        },\r\n        delItem(i) {\r\n            this.list.splice(i, 1)\r\n        },\r\n        getid(item) {\r\n            item = toRaw(item)\r\n            if (item._id_ === undefined) {\r\n                let i = 0\r\n                while (this.list.some(x => x._id_ == i)) i++\r\n                item._id_ = i\r\n            }\r\n            return item._id_\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","import { render } from \"./SheetUI.vue?vue&type=template&id=072795c2\"\nimport script from \"./SheetUI.vue?vue&type=script&lang=js\"\nexport * from \"./SheetUI.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <tr>\r\n        <label for=\"curvature\">c=</label>\r\n        <OpticVarInput id=\"curvature\" type=\"number\"\r\n            :step=\"0.0001\"\r\n            :variable=\"surface.shape.curvature\" />\r\n\r\n\r\n        <span>, </span>\r\n        <label for=\"thickness\">t=</label>\r\n        <OpticVarInput id=\"thickness\" :step=\"0.01\"\r\n            :variable=\"surface.thickness\" />\r\n\r\n        <span>, </span>\r\n        <label for=\"material\">n=</label>\r\n        <input id=\"material\" type=\"number\" step=\"0.01\"\r\n            min=\"1\" max=\"99\"\r\n            v-model.number=\"surface.material.index\">\r\n\r\n\r\n        <span> (R={{ (1 /\r\n                surface.shape.curvature.value).toPrecision(4)\r\n        }})\r\n        </span>\r\n    </tr>\r\n</template>\r\n\r\n<script>\r\nimport OpticSurface from '@/optic/OpticSurface'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        surface: OpticSurface\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","<template>\r\n    <div class=\"optic_var_input\" :class=\"{\r\n        'optic_var_input-editmode': editmode,\r\n        'optic_var_input-optimize': variable.optimize\r\n    }\">\r\n        <input class=\"draggable\" ref=\"input\" type=\"number\"\r\n            v-model=\"variable.value\" :step=\"step\">\r\n\r\n        <div ref=\"menu\" class=\"optic_var_input-menu\"\r\n            v-if=\"editmode\" @mousedown=\"menuclick\">\r\n            <div class=\"ui_block\">\r\n                <div class=\"ui_block-body\">\r\n                    <div class=\"content\">\r\n                        <input type=\"checkbox\"\r\n                            name=\"optimize\" id=\"optimize\"\r\n                            v-model=\"variable.optimize\">\r\n                        <label\r\n                            for=\"optimize\">Optimize</label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticVar from '@/optic/OpticVar'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        variable: OpticVar,\r\n        step: Number\r\n    },\r\n    data() {\r\n        return {\r\n            editmode: false,\r\n            tweakmode: false,\r\n            tweaked: false,\r\n            tempValue: this.variable.value\r\n        }\r\n    },\r\n    methods: {\r\n        mousedown(event) {\r\n            this.tempValue = this.variable.value\r\n            if (!this.editmode) {\r\n                event.preventDefault()\r\n                this.tweakmode = true\r\n                this.tweaked = false\r\n            }\r\n        },\r\n        mouseup(event) {\r\n            if (this.tweakmode && !this.tweaked) {\r\n                this.editmode = true\r\n                this.tweakmode = false\r\n                this.$refs.input.focus()\r\n            }\r\n            this.tweakmode = false\r\n        },\r\n        mousemove(event) {\r\n            if (this.tweakmode) {\r\n                this.tweaked = true\r\n                this.tempValue += event.movementX * this.step\r\n                this.updatevalue()\r\n            }\r\n        },\r\n        reset(event) {\r\n            this.editmode = false\r\n            this.tweakmode = false\r\n        },\r\n        menuclick(event) {\r\n            event.preventDefault()\r\n        },\r\n        updatevalue: throttle(10, function () {\r\n            this.variable.value = this.tempValue\r\n        })\r\n    },\r\n    mounted() {\r\n        this.$refs.input.addEventListener(\"mousedown\", this.mousedown)\r\n        addEventListener(\"mouseup\", this.mouseup)\r\n        addEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.addEventListener(\"blur\", this.reset)\r\n    },\r\n    beforeUnmount() {\r\n        this.$refs.input.removeEventListener(\"mousedown\", this.mousedown)\r\n        removeEventListener(\"mouseup\", this.mouseup)\r\n        removeEventListener(\"mousemove\", this.mousemove)\r\n        this.$refs.input.removeEventListener(\"blur\", this.reset)\r\n\r\n    }\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.optic_var_input {\r\n    display: inline-block;\r\n    position: relative;\r\n\r\n    input.draggable {\r\n        cursor: ew-resize;\r\n    }\r\n\r\n    &-editmode {\r\n        input.draggable {\r\n            cursor: text;\r\n            background: #333;\r\n        }\r\n    }\r\n\r\n    &-optimize {\r\n        input.draggable {\r\n            background-color: darkcyan;\r\n        }\r\n    }\r\n\r\n    &-menu {\r\n        z-index: 1;\r\n        position: absolute;\r\n\r\n        top: 100%;\r\n        left: 0;\r\n\r\n        width: max-content;\r\n        height: fit-content;\r\n        box-sizing: border-box;\r\n    }\r\n\r\n}\r\n</style>","function asyncThrottle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    async function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout == null) {\r\n            timeout = 0\r\n            await fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nfunction throttle(time, fun) {\r\n    let timeout = null\r\n    let dirty = false\r\n    let thisarg = null\r\n    let args = []\r\n    function delayed() {\r\n        dirty = true\r\n        thisarg = this\r\n        args = arguments\r\n        if (timeout == null) {\r\n            fun.apply(thisarg, args)\r\n            dirty = false\r\n\r\n            timeout = setTimeout(function () {\r\n                timeout = null\r\n                if (dirty) delayed.apply(thisarg, args)\r\n            }, time)\r\n        }\r\n    }\r\n    return delayed\r\n}\r\n\r\nexport { throttle, asyncThrottle }","import { render } from \"./OpticVarInput.vue?vue&type=template&id=04e56cad&scoped=true\"\nimport script from \"./OpticVarInput.vue?vue&type=script&lang=js\"\nexport * from \"./OpticVarInput.vue?vue&type=script&lang=js\"\n\nimport \"./OpticVarInput.vue?vue&type=style&index=0&id=04e56cad&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-04e56cad\"]])\n\nexport default __exports__","import { render } from \"./OpticSurfaceComponent.vue?vue&type=template&id=6cdbd58e\"\nimport script from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticSurfaceComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","const ViewState = {\r\n    focusedSurface: null,\r\n    colorlist: [\r\n        \"red\", \"green\", \"blue\", \"yellow\", \"cyan\", \"magenta\"\r\n    ]\r\n}\r\n\r\n\r\n\r\nexport default ViewState","import { render } from \"./LensSheet.vue?vue&type=template&id=41ea9ed4\"\nimport script from \"./LensSheet.vue?vue&type=script&lang=js\"\nexport * from \"./LensSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"lens_plot ui_block\">\r\n        <div class=\"ui_block-header \">\r\n            <p>Plot</p>\r\n        </div>\r\n        <div class=\" ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"lens_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport PlotTrace from '@/optic/analyze/PlotTrace'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null,\r\n            ViewState: ViewState\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        update: asyncThrottle(10, async function () {\r\n            if (this.ctx === null) return\r\n            \r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await Promise.all(PlotTrace(this.system).map(x => x.array()))\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n            let ttl = 0\r\n\r\n            for (let surface of this.system.surfaces) {\r\n                ttl += surface.thickness.value\r\n            }\r\n\r\n\r\n\r\n\r\n            let Rlist = []\r\n            let Rmax = 0\r\n            for (let j = 1; j < result.length; j++) {\r\n                let R = 0\r\n                for (let i = 0; i < result[0][0].length; i++) {\r\n                    let y = result[j][1][i]\r\n                    if (isNaN(y)) continue\r\n                    R = Math.max(R, Math.abs(y))\r\n                }\r\n                Rlist.push(R)\r\n                Rmax = Math.max(R, Rmax)\r\n            }\r\n\r\n            let scale = canvas.width / ttl * 0.9\r\n\r\n            scale = Math.min(scale, canvas.height / Rmax / 2 * 0.9)\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(-ttl / 2, 0)\r\n\r\n\r\n            ctx.lineWidth = 2 / scale\r\n\r\n            ctx.strokeStyle = \"#333\"\r\n            ctx.beginPath()\r\n            ctx.moveTo(0, 0)\r\n            ctx.lineTo(ttl, 0)\r\n            ctx.stroke()\r\n\r\n\r\n            ctx.strokeStyle = '#EEE'\r\n\r\n\r\n\r\n            const N = 50\r\n\r\n            let z0 = 0\r\n\r\n            ctx.fillStyle = '#111'\r\n\r\n\r\n            for (let j = 0; j < this.system.surfaces.length; j++) {\r\n                let surface = this.system.surfaces[j]\r\n                let R = Rlist[j]\r\n\r\n                let isSolid = j < this.system.surfaces.length - 1 && surface.material.index > 1\r\n\r\n                if (isSolid) {\r\n                    R = Math.max(R, Rlist[j + 1])\r\n                }\r\n\r\n                ctx.beginPath()\r\n                for (let i = 0; i <= N; i++) {\r\n                    let r = (i / N - 0.5) * 2 * R\r\n                    let z = surface.shape.surface(r)\r\n                    if (isNaN(r) || isNaN(z)) continue\r\n                    if (i == 0)\r\n                        ctx.moveTo(z0 + z, r)\r\n                    else\r\n                        ctx.lineTo(z0 + z, r)\r\n                }\r\n\r\n                if (isSolid) {\r\n                    let nextsurface = this.system.surfaces[j + 1]\r\n\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = -(i / N - 0.5) * 2 * R\r\n                        let z = nextsurface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        ctx.lineTo(z0 + z + surface.thickness.value, r)\r\n                    }\r\n\r\n                    ctx.closePath()\r\n                    ctx.fill()\r\n                }\r\n                ctx.stroke()\r\n\r\n\r\n                if (surface == ViewState.focusedSurface) {\r\n                    ctx.save()\r\n                    ctx.strokeStyle = \"orange\"\r\n                    ctx.lineWidth = 3 / scale\r\n                    ctx.beginPath()\r\n                    for (let i = 0; i <= N; i++) {\r\n                        let r = (i / N - 0.5) * 2 * R\r\n                        let z = surface.shape.surface(r)\r\n                        if (isNaN(r) || isNaN(z)) continue\r\n                        if (i == 0)\r\n                            ctx.moveTo(z0 + z, r)\r\n                        else\r\n                            ctx.lineTo(z0 + z, r)\r\n                    }\r\n                    ctx.stroke()\r\n                    ctx.restore()\r\n                }\r\n\r\n\r\n                z0 += surface.thickness.value\r\n            }\r\n\r\n\r\n            // Draw Rays\r\n            ctx.lineWidth = 1.5 / scale\r\n\r\n            for (let i = 0; i < result[0][0].length; i++) {\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                ctx.beginPath()\r\n                for (let j = 0; j < result.length; j++) {\r\n                    let y = result[j][1][i]\r\n                    let z = result[j][2][i]\r\n                    if (j == 0) ctx.moveTo(z, y)\r\n                    else ctx.lineTo(z, y)\r\n                }\r\n                ctx.stroke()\r\n            }\r\n\r\n        }, 50)\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        },\r\n        ViewState: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.lens_plot {\r\n    position: relative;\r\n    width: 500px;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport { toRaw } from \"vue\"\r\n\r\n\r\n/**\r\n * @param {OpticSystem} system \r\n * @param {tf.Tensor} raypos\r\n * @param {tf.Tensor} raydir \r\n*/\r\nfunction RayTrace(system, raypos, raydir) {\r\n    return tf.tidy(() => {\r\n\r\n        let result = []\r\n        result.push(raypos)\r\n\r\n        let n1 = 1\r\n        let z = tf.tensor(0)\r\n        for (let surface of system.surfaces) {\r\n            let n2 = surface.material.index\r\n\r\n\r\n            raypos = surface.shape.trace(raypos.sub(tf.tensor([[0], [0], [1]]).mul(z)), raydir)\r\n            let normal = surface.shape.normal(raypos)\r\n\r\n\r\n            raydir = raydir.div(raydir.mul(raydir).sum(0).sqrt()).mul(n1)\r\n            normal = normal.mul(raydir.mul(normal).sum(0).sign())\r\n            let cos = raydir.mul(normal).sum(0)\r\n            let tangent2 = tf.sub(n1 ** 2, cos.mul(cos))\r\n            let displace = tf.sub(n2 ** 2, tangent2).sqrt().sub(tf.sub(n1 ** 2, tangent2).sqrt())\r\n            raydir = raydir.add(normal.mul(displace))\r\n\r\n\r\n            raypos = raypos.add(tf.tensor([[0], [0], [1]]).mul(z))\r\n            result.push(raypos)\r\n            n1 = n2\r\n\r\n            z = z.add(toRaw(surface.thickness.value))\r\n        }\r\n\r\n\r\n        // result.push(raypos.add(raydir).arraySync())\r\n\r\n        return result\r\n    })\r\n}\r\n\r\n\r\nexport default RayTrace","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction PlotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 7\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n        for (let field of system.fields) {\r\n            let f = (i / N - 0.5) * 2\r\n            raypos.push(field.raypos(0, f, system))\r\n            raydir.push(field.raydir(0, f, system))\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    return RayTrace(system, raypos, raydir)\r\n}\r\n\r\nexport default PlotTrace","import { render } from \"./LensPlot.vue?vue&type=template&id=9796c7f6&scoped=true\"\nimport script from \"./LensPlot.vue?vue&type=script&lang=js\"\nexport * from \"./LensPlot.vue?vue&type=script&lang=js\"\n\nimport \"./LensPlot.vue?vue&type=style&index=0&id=9796c7f6&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-9796c7f6\"]])\n\nexport default __exports__","import OpticSystem from \"./OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\ntf.setBackend('cpu')\r\nconst system = new OpticSystem()\r\n\r\nexport default {\r\n    system\r\n}","<template>\r\n    <div class=\"ui_sheet ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Field Data</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"content\">\r\n                <label for=\"diameter\">D=</label>\r\n                <OpticVarInput id=\"diameter\" :step=\"0.01\"\r\n                    :variable=\"system.pupilDiameter\" />\r\n\r\n                <label for=\"Z\">Z=</label>\r\n                <OpticVarInput id=\"Z\" :step=\"0.01\"\r\n                    :variable=\"system.pupilOffset\" />\r\n            </div>\r\n            <SheetUI :list=\"system.fields\"\r\n                :builder=\"buildField\">\r\n                <template #item=\"[field, i]\">\r\n                    <OpticFieldComponent :field=\"field\"\r\n                        :key=\"i\">\r\n                    </OpticFieldComponent>\r\n                </template>\r\n            </SheetUI>\r\n\r\n            <div class=\"content\">\r\n                <p>D=Entrance Diameter, Z=Distance to the\r\n                    pupil</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport OpticFieldComponent from './OpticFieldComponent.vue'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\nimport SheetUI from './common/SheetUI.vue'\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    components: {\r\n        OpticFieldComponent,\r\n        OpticVarInput,\r\n        SheetUI\r\n    },\r\n    methods: {\r\n        buildField(i) {\r\n            return new OpticField()\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>","<template>\r\n    <div>\r\n        <label for=\"angle\">angle=</label>\r\n        <OpticVarInput id=\"angle\" :step=\"0.02\"\r\n            :variable=\"field.angle\" />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticField from '@/optic/OpticField'\r\nimport OpticVarInput from './common/OpticVarInput.vue'\r\n\r\nexport default {\r\n    props: {\r\n        field: OpticField\r\n    },\r\n    components: {\r\n        OpticVarInput\r\n    },\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import { render } from \"./OpticFieldComponent.vue?vue&type=template&id=3c010f90\"\nimport script from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\nexport * from \"./OpticFieldComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./FieldSheet.vue?vue&type=template&id=6f6c0f96\"\nimport script from \"./FieldSheet.vue?vue&type=script&lang=js\"\nexport * from \"./FieldSheet.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"analyze_plot ui_block\">\r\n        <div class=\"ui_block-header\">\r\n            <p>Spot Diagram</p>\r\n        </div>\r\n        <div class=\"ui_block-body\">\r\n            <div ref=\"container\"\r\n                class=\"analyze_plot-container\">\r\n                <canvas ref=\"canvas\"></canvas>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport SpotTrace from '@/optic/analyze/SpotTrace'\r\nimport { toRaw } from 'vue'\r\n\r\nimport { asyncThrottle } from '@/scripts/throttle'\r\nimport { stopForAxis } from '@tensorflow/tfjs-core/dist/ops/slice_util'\r\nimport ViewState from './ViewControl'\r\n\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            canvas: null,\r\n            ctx: null\r\n        }\r\n    },\r\n    methods: {\r\n        resize() {\r\n            const rect = this.$refs.container.getBoundingClientRect()\r\n            this.$refs.canvas.width = rect.width\r\n            this.$refs.canvas.height = rect.height\r\n            this.update()\r\n        },\r\n        update: asyncThrottle(10, async function () {\r\n            if (this.ctx === null) {\r\n                console.error('ctx not ready')\r\n            }\r\n            /**@type {HTMLCanvasElement} */\r\n            const canvas = this.canvas\r\n            /**@type {CanvasRenderingContext2D} */\r\n            const ctx = this.ctx\r\n\r\n\r\n            // RAYTRACE\r\n            const result = await SpotTrace(this.system).array()\r\n\r\n            // Plot\r\n            ctx.resetTransform()\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n            ctx.translate(canvas.width / 2, canvas.height / 2)\r\n\r\n\r\n            ctx.beginPath()\r\n            let ymax = result[1][0]\r\n            let ymin = result[1][0]\r\n\r\n\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                let y = result[1][i]\r\n                if (isNaN(y)) continue\r\n                ymax = Math.max(y, ymax)\r\n                ymin = Math.min(y, ymin)\r\n            }\r\n\r\n            let scale = canvas.height / (ymax - ymin + 2) * 0.8\r\n\r\n            ctx.scale(scale, scale)\r\n            ctx.translate(0, -(ymax + ymin) / 2)\r\n            ctx.lineWidth = 1 / scale\r\n            for (let i = 0; i < result[0].length; i++) {\r\n                ctx.beginPath()\r\n                ctx.strokeStyle = ViewState.colorlist[i % this.system.fields.length % ViewState.colorlist.length]\r\n                let x = result[0][i]\r\n                let y = result[1][i]\r\n                ctx.rect(x - 1 / scale, y - 1 / scale, 2 / scale, 2 / scale)\r\n                ctx.stroke()\r\n            }\r\n        })\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                this.update()\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.canvas = this.$refs.canvas\r\n        this.ctx = this.canvas.getContext('2d')\r\n        addEventListener(\"resize\", this.resize)\r\n        this.resize()\r\n    },\r\n    unmounted() {\r\n        removeEventListener(\"resize\", this.resize)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.analyze_plot {\r\n    position: relative;\r\n    width: 200px;\r\n    height: 100%;\r\n\r\n    &-container {\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        canvas {\r\n            position: absolute;\r\n            background-color: black;\r\n            border-radius: 4px;\r\n        }\r\n    }\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction SpotTrace(system) {\r\n    let raypos = []\r\n    let raydir = []\r\n    let N = 5\r\n\r\n    // Go through every field and create rays\r\n    for (let i = 0; i <= N; i++) {\r\n\r\n\r\n        let f = i / N\r\n\r\n        let N2 = f * 16 + 1\r\n        for (let j = 0; j < N2; j++) {\r\n\r\n            let f2 = j / N2\r\n\r\n            let fx = f * Math.cos(f2 * Math.PI * 2)\r\n            let fy = f * Math.sin(f2 * Math.PI * 2)\r\n\r\n            for (let field of system.fields) {\r\n                raypos.push(field.raypos(fx, fy, system))\r\n                raydir.push(field.raydir(fx, fy, system))\r\n            }\r\n        }\r\n    }\r\n\r\n    raypos = tf.tensor(raypos).transpose()\r\n    raydir = tf.tensor(raydir).transpose()\r\n\r\n    let result = RayTrace(system, raypos, raydir)\r\n    let spot = result[result.length - 1]\r\n\r\n    return spot\r\n}\r\n\r\nexport default SpotTrace","import { render } from \"./AnalyzePlot.vue?vue&type=template&id=0dfd1afe&scoped=true\"\nimport script from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\nexport * from \"./AnalyzePlot.vue?vue&type=script&lang=js\"\n\nimport \"./AnalyzePlot.vue?vue&type=style&index=0&id=0dfd1afe&scoped=true&lang=scss\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0dfd1afe\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"optimize_wizard ui_block\">\r\n        <div class=\"ui_block-header\">Optimizer</div>\r\n        <div class=\"ui_block-body\">\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\"\r\n                    name=\"updateOnSystemChange\"\r\n                    id=\"updateOnSystemChange\"\r\n                    v-model=\"updateOnSystemChange\">\r\n                <label for=\"updateOnSystemChange\">Update\r\n                    merit on\r\n                    change</label>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <p>Current Merit: {{\r\n                        merit.toPrecision(6)\r\n                }}\r\n                </p>\r\n\r\n            </div>\r\n            <div class=\"row content\">\r\n                <button @click=\"updateMerit\">Calculate\r\n                    Current</button>\r\n\r\n                <button @click=\"stop\"\r\n                    v-if=\"this.iterate\">Stop!</button>\r\n                <button @click=\"optimize\"\r\n                    v-else>Optimize!</button>\r\n            </div>\r\n            <div class=\"row content\">\r\n                <label for=\"maxIteration\">Max:</label>\r\n                <input type=\"number\" name=\"maxIteration\"\r\n                    id=\"maxIteration\"\r\n                    v-model=\"maxIteration\">\r\n                <p>Iterations: {{ iterations }}</p>\r\n            </div>\r\n\r\n            <div class=\"row content\">\r\n                <input type=\"checkbox\" name=\"updateView\"\r\n                    id=\"updateView\" v-model=\"updateView\">\r\n                <label for=\"updateView\">Update\r\n                    view</label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport OpticSystem from '@/optic/OpticSystem'\r\nimport Optimize from '@/optic/analyze/Optimize'\r\nimport Merit from '@/optic/analyze/Merit'\r\nimport { throttle } from '@/scripts/throttle'\r\n\r\nexport default {\r\n    props: {\r\n        system: OpticSystem\r\n    },\r\n    data() {\r\n        return {\r\n            merit: 0,\r\n            iterate: null,\r\n            apply: null,\r\n            iterations: 0,\r\n            maxIteration: 20,\r\n            timeout: null,\r\n            updateOnSystemChange: true,\r\n            updateView: false\r\n        }\r\n    },\r\n    methods: {\r\n        updateMerit: throttle(10, function () {\r\n            this.merit = Merit(this.system).arraySync()[0]\r\n        }),\r\n        async optimize() {\r\n            this.iterations = 0\r\n            let [iterate, apply] = await Optimize(this.system)\r\n            this.iterate = iterate\r\n            this.apply = apply\r\n            this.update()\r\n        },\r\n        update() {\r\n            if (this.timeout) clearTimeout(this.timeout)\r\n            if (this.iterations >= this.maxIteration) this.stop()\r\n            else if (this.iterate) {\r\n                let vm = this\r\n                this.iterate().then((merit) => {\r\n                    this.merit = merit\r\n                    if (this.updateView) this.apply()\r\n                    vm.timeout = setTimeout(() => {\r\n                        vm.iterations += 1\r\n                        vm.update()\r\n                    }, 0)\r\n                })\r\n            }\r\n        },\r\n        stop() {\r\n            if (this.apply) {\r\n                this.system.update += 1\r\n                this.apply()\r\n                this.apply = null\r\n            }\r\n            this.updateMerit()\r\n            this.iterate = null\r\n            clearTimeout(this.timeout)\r\n            this.timeout = null\r\n        }\r\n    },\r\n    watch: {\r\n        system: {\r\n            handler() {\r\n                if (this.updateOnSystemChange && !this.iterate) {\r\n                    this.updateMerit()\r\n                }\r\n            },\r\n            deep: true\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.optimize_wizard {\r\n    max-width: 300px;\r\n}\r\n</style>","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport RayTrace from \"./RayTrace\"\r\n\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nfunction Merit(system) {\r\n    return tf.tidy(() => {\r\n\r\n        let merit = tf.tensor([0])\r\n\r\n        for (let field of system.fields) {\r\n            merit = tf.tidy(() => {\r\n                const raypos1 = []\r\n                const raydir1 = []\r\n                const N = 3\r\n\r\n                // Go through every field and create rays\r\n                for (let i = 0; i <= N; i++) {\r\n                    const f = i / N\r\n                    const N2 = 3 * f + 1\r\n\r\n                    for (let j = 0; j <= N2; j++) {\r\n                        const f2 = j / N2 - 0.5\r\n                        const fx = f * Math.cos(f2 * Math.PI)\r\n                        const fy = f * Math.sin(f2 * Math.PI)\r\n                        raypos1.push(field.raypos(fx, fy, system))\r\n                        raydir1.push(field.raydir(fx, fy, system))\r\n                    }\r\n                }\r\n\r\n                const raypos = tf.tensor(raypos1).transpose()\r\n                const raydir = tf.tensor(raydir1).transpose()\r\n\r\n                const result = RayTrace(system, raypos, raydir)\r\n                const spot = result[result.length - 1]\r\n\r\n                const delta = spot.sub(spot.gather(0, 1).expandDims(1))\r\n\r\n                const error = delta.mul(delta)\r\n                const mask = error.isNaN().logicalNot()\r\n                const maxerror = error.where(mask, 0).max().add(1e5)\r\n                return merit.add(error.where(mask, maxerror).sum())\r\n            })\r\n        }\r\n\r\n        return merit\r\n    })\r\n}\r\n\r\nexport default Merit","import OpticSystem from \"../OpticSystem\"\r\nimport * as tf from \"@tensorflow/tfjs\"\r\nimport Merit from \"./Merit\"\r\nimport { toRaw } from \"vue\"\r\n\r\n/**\r\n * \r\n * @param {OpticSystem} system \r\n * @returns \r\n */\r\nasync function Optimize(system) {\r\n\r\n\r\n    let variables = []\r\n    variables.push(system.pupilOffset)\r\n    for (let surface of system.surfaces) {\r\n        variables.push(surface.shape.curvature)\r\n        variables.push(surface.thickness)\r\n    }\r\n\r\n    variables = variables.filter(x => x.optimize)\r\n\r\n    let rawVariables = variables.map(toRaw)\r\n    let x0 = rawVariables.map(x => x.value)\r\n\r\n\r\n    async function evaluate(x) {\r\n        rawVariables.map((variable, i) => {\r\n            variable.value = x[i]\r\n        })\r\n        return (await Merit(system).array())[0]\r\n    }\r\n\r\n    async function evaluateAll(seeds, scores) {\r\n        for (let i = 0; i < seeds.length; i++) {\r\n            scores[i] = await evaluate(seeds[i])\r\n        }\r\n    }\r\n\r\n    const seeds = [x0]\r\n\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * 0.01))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.01) * 0.5))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n    seeds.push(x0.map(x => x + (Math.random() - 0.5) * (Math.abs(x) + 0.1) * 0.1))\r\n\r\n    const N = seeds.length\r\n\r\n\r\n    const scores = []\r\n    const newScores = []\r\n    const newSeeds = []\r\n    await evaluateAll(seeds, scores)\r\n\r\n    let bestScore = scores[0]\r\n    let bestSeed = seeds[0]\r\n\r\n\r\n    async function iterate(F = 0.9) {\r\n        for (let i = 0; i < N; i++) {\r\n            const a = Math.floor(Math.random() * N)\r\n            const b = Math.floor(Math.random() * N)\r\n            const c = Math.floor(Math.random() * N)\r\n            const z = Math.floor(Math.random() * N)\r\n\r\n            const A = seeds[a]\r\n            const B = seeds[b]\r\n            const C = seeds[c]\r\n\r\n            newSeeds[i] = seeds[i].map((x, j) => {\r\n                if (j !== z && Math.random() < 0.3) return x\r\n                return A[j] + (B[j] - C[j]) * F\r\n            })\r\n        }\r\n\r\n        await evaluateAll(newSeeds, newScores)\r\n\r\n        for (let i = 0; i < N; i++) {\r\n            if (!isNaN(newScores[i]) && newScores[i] < scores[i]) {\r\n                scores[i] = newScores[i]\r\n                seeds[i] = newSeeds[i]\r\n\r\n                if (isNaN(bestScore) || scores[i] < bestScore) {\r\n                    bestScore = scores[i]\r\n                    bestSeed = seeds[i]\r\n                }\r\n            }\r\n        }\r\n\r\n        return bestScore\r\n    }\r\n\r\n    function apply() {\r\n        rawVariables.map((x, i) => {\r\n            x.value = null\r\n        })\r\n        variables.map((x, i) => {\r\n            x.value = bestSeed[i]\r\n        })\r\n    }\r\n\r\n    return [iterate.bind(this), apply.bind(this)]\r\n}\r\n\r\nexport default Optimize","import { render } from \"./OptimizeWizard.vue?vue&type=template&id=2fd3bb79&scoped=true\"\nimport script from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\nexport * from \"./OptimizeWizard.vue?vue&type=script&lang=js\"\n\nimport \"./OptimizeWizard.vue?vue&type=style&index=0&id=2fd3bb79&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2fd3bb79\"]])\n\nexport default __exports__","function debounce(time, fun) {\r\n\r\n    let timeout = null\r\n    let thisarg = null\r\n    let args = []\r\n\r\n    function delayed() {\r\n        thisarg = this\r\n        args = arguments\r\n\r\n        if (timeout) {\r\n            clearTimeout(timeout)\r\n        }\r\n\r\n        timeout = setTimeout(function () {\r\n            fun.apply(thisarg, args)\r\n            timeout = null\r\n        }, time)\r\n    }\r\n    return delayed\r\n}\r\n\r\n\r\nexport { debounce }","import { render } from \"./App.vue?vue&type=template&id=9c94eec8&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=9c94eec8&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Documents\\\\Github\\\\OpticTool\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-9c94eec8\"]])\n\nexport default __exports__","\r\nimport { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport './style/index.scss'\r\ncreateApp(App).mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkoptictool\"] = self[\"webpackChunkoptictool\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(57); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","onClick","$options","_hoisted_5","stateHead","state","length","this","_hoisted_6","_createVNode","_component_LensPlot","system","$data","_component_AnalyzePlot","_hoisted_7","_component_LensSheet","_component_FieldSheet","_component_OptimizeWizard","_hoisted_8","_component_SheetUI","list","$props","surfaces","builder","item","surface","i","_createBlock","_component_OpticSurfaceComponent","key","compress","str","replaceAll","decompress","Serializer","serializable","classname","param2v","serializer","Class","classdefs","console","error","name","classnames","v2param","serialize","object","JSON","stringify","_serialize","Array","map","x","Object","obj","constructor","_","p2v","deserialize","_deserialize","parse","classdef","v2p","OpticMaterial","index","OpticVar","value","optimize","ensurevalue","v","tf","arraySync","OpticShapeSpherical","curvature","trace","raypos","raydir","c","toRaw","l","gather","div","mul","A","sum","B","sub","C","sqrt","dispose","add","normal","p","n","r","r2","Math","OpticSurface","thickness","shape","material","OpticField","angle","fx","fy","R","pupilDiameter","PZ","pupilOffset","a","z","y","sin","PI","cos","OpticSystem","fields","_TransitionGroup","tag","_Fragment","_renderSlot","_ctx","props","Function","methods","addItem","splice","delItem","getid","undefined","_id_","some","__exports__","for","_component_OpticVarInput","id","type","step","variable","min","max","toPrecision","ref","onMousedown","asyncThrottle","time","fun","timeout","dirty","thisarg","args","async","delayed","arguments","apply","setTimeout","throttle","Number","data","editmode","tweakmode","tweaked","tempValue","mousedown","event","preventDefault","mouseup","$refs","input","focus","mousemove","movementX","updatevalue","reset","menuclick","mounted","addEventListener","beforeUnmount","removeEventListener","components","OpticVarInput","ViewState","focusedSurface","colorlist","OpticSurfaceComponent","SheetUI","buildSurface","hover","RayTrace","result","push","n1","n2","sign","tangent2","displace","PlotTrace","N","field","f","transpose","canvas","ctx","resize","rect","container","getBoundingClientRect","width","height","update","Promise","all","array","resetTransform","clearRect","translate","ttl","Rlist","Rmax","j","isNaN","abs","scale","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","z0","fillStyle","isSolid","nextsurface","closePath","fill","save","restore","watch","handler","deep","getContext","unmounted","_component_OpticFieldComponent","OpticFieldComponent","buildField","SpotTrace","N2","f2","spot","ymax","ymin","iterate","_hoisted_9","_hoisted_10","_hoisted_11","Merit","merit","raypos1","raydir1","delta","expandDims","mask","logicalNot","maxerror","where","Optimize","variables","filter","rawVariables","x0","evaluate","evaluateAll","seeds","scores","random","newScores","newSeeds","bestScore","bestSeed","F","floor","b","bind","iterations","maxIteration","updateOnSystemChange","updateView","updateMerit","clearTimeout","stop","vm","then","debounce","optic","no_record","LensSheet","LensPlot","FieldSheet","AnalyzePlot","OptimizeWizard","undo","load","redo","open","document","createElement","onchange","reader","FileReader","readAsText","files","onload","e","target","click","filename","contents","blob","Blob","File","createEvent","download","href","window","URL","createObjectURL","dataset","downloadurl","join","render","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","amdD","Error","amdO","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","keys","every","getter","__esModule","d","definition","o","defineProperty","enumerable","get","g","globalThis","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","forEach","__webpack_exports__"],"sourceRoot":""}